var ticket_submit_order={ticket_type:{adult:"1",child:"2",student:"3",disability:"4"},ticket_type_name:{"1":"成人票","2":"孩票","3":"学生票","4":"伤残军人票"},tour_flag:{dc:"dc",wc:"wc",fc:"fc",gc:"gc",lc1:"l1",lc2:"l2"},passenger_type:{adult:"1",child:"2",student:"3",disability:"4"},passenger_card_type:{two:"1",one:"2",tmp:"3",passport:"B",work:"H",hongkong_macau:"C",taiwan:"G"},request_flag:{isAsync:"1"},ticket_query_flag:{query_commom:"00",query_student:"0X00"},seatType:{yz_type:"1"},special_areas:{lso:"LSO",dao:"DAO",ado:"ADO",nqo:"NQO",tho:"THO"}};
function OrderQueueWaitTime(a,c,b){this.tourFlag=a;this.waitMethod=c;this.finishMethod=b;this.dispTime=1;this.nextRequestTime=1;this.isFinished=false;this.waitObj}OrderQueueWaitTime.prototype.start=function(){var a=this;a.timerJob();window.setInterval(function(){a.timerJob()},1000)};OrderQueueWaitTime.prototype.timerJob=function(){if(this.isFinished){return}if(this.dispTime<=0){this.isFinished=true;this.finishMethod(this.tourFlag,this.dispTime,this.waitObj);return}if(this.dispTime==this.nextRequestTime){this.getWaitTime()}var a=this.dispTime;var c="";var b=parseInt(a/60);if(b>=1){c=b+"分";a=a%60}else{c="1分"}this.waitMethod(this.tourFlag,this.dispTime>1?--this.dispTime:1,c)};OrderQueueWaitTime.prototype.getWaitTime=function(){var a=this;$.ajax({url:ctx+"confirmPassenger/queryOrderWaitTime?random="+new Date().getTime(),type:"GET",data:{tourFlag:a.tourFlag},dataType:"json",success:function(c){var e=c.data;if(!e.queryOrderWaitTimeStatus){window.location.href=ctx+"login/init?random="+new Date().getTime()}else{if(e!=null){a.waitObj=e;a.dispTime=e.waitTime;var d=parseInt(e.waitTime/1.5);d=d>60?60:d;var b=e.waitTime-d;a.nextRequestTime=b<=0?1:b}}},error:function(b,d,c){return false}})};
var defaultLoadGrayBackgroundModalbox="";var loadGrayBackground;var unLoadGrayBackground;(function(){loadGrayBackground=function(){var a=dhtmlx.modalbox({targSrc:'<div><img src="'+ctx+'resources/images/loading.gif"></img></div>',callback:function(){}});defaultLoadGrayBackgroundModalbox=a};unLoadGrayBackground=function(){if(defaultLoadGrayBackgroundModalbox!=""){dhtmlx.modalbox.hide(defaultLoadGrayBackgroundModalbox);defaultLoadGrayBackgroundModalbox=""}}})();
