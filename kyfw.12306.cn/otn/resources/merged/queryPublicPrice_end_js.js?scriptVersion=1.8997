(function(C){jQuery.extend({ht_getcookie:function(W){var k=document.cookie.indexOf(W);var i=document.cookie.indexOf(";",k);return k==-1?"":unescape(document.cookie.substring(k+W.length+1,(i>k?i:document.cookie.length)))},ht_setcookie:function(aa,Z,Y,X,k,W){var i=new Date();i.setTime(i.getTime()+Y*1000);document.cookie=escape(aa)+"="+escape(Z)+(i?"; expires="+i.toGMTString():"")+(X?"; path="+X:"; path=/")+(k?"; domain="+k:"")+(W?"; secure":"")},textFocus:function(W){var k,i,W=W===undefined?0:parseInt(W);this.each(function(){if(!this.setSelectionRange){k=this.createTextRange();W===0?k.collapse(false):k.move("character",W);k.select()}else{i=this.value.length;W===0?this.setSelectionRange(i,i):this.setSelectionRange(W,W)}this.focus()});return this}});var w=[];var D=[];var E=[];var G=[];var v=0;var y=0;var A=0;var S=0;var U=false;var g=false;var H=false;var z=0;var I=null;var m=-1;var N={};var f=[];var e=[];var d=[];var b=[];var V=[];var F=new Array("a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z");var j=[];var x=false;var c=[];for(var R=0;R<26;R++){c[R]=[]}var P=[];for(var T=0;T<5;T++){P[T]=[]}var t=[];var s=[];var q=[];var p=[];var o=[];var K=[];var a=false;var L=true;var u=12;var h="简码/汉字";var n="简码/汉字";var r="inp-txt_select";var l="inp-txt";var B=false;var J=null;var Q=null;var M=false;var O=C.ht_getcookie("hj_favcity");C.stationFor12306={bindInputs:[],get_initInputValue:function(){return h},get_initTopInputValue:function(){return n},city_Bind:function(k){if(k.length==0){return}var i="";C.each(k,function(W){if(O==k[W][2]){i+="<div class='cityline' id='citem_"+W+"' cturn='"+k[W][6]+"'><span class='ralign'><b>"+k[W][1]+"</b></span></div>\n"}else{i+="<div class='cityline' id='citem_"+W+"' cturn='"+k[W][6]+"'><span class='ralign'>"+k[W][1]+"</span><span style='float:right;' class='ralign'>"+k[W][3]+"</span></div>\n"}});C("#panel_cities").html(i);C(".cityline").mouseover(function(){C.stationFor12306.city_shiftSelect(this)}).click(function(){C.stationFor12306.city_confirmSelect();E=C.stationFor12306.filterCity("");C.stationFor12306.city_showlist(0)});C.stationFor12306.city_shiftSelect(C("#citem_0"))},city_changeSelectIndex:function(i){var k=A+i;if(k==-1){C.stationFor12306.city_showlist(z-1);C.stationFor12306.city_shiftSelect(C("#citem_"+(G.length-1)))}else{if(k==G.length){C.stationFor12306.city_showlist(z+1);C.stationFor12306.city_shiftSelect(C("#citem_0"))}else{C.stationFor12306.city_shiftSelect(C("#citem_"+k))}}},city_confirmSelect:function(){I.val(S[1]);curObjCode.val(S[2]);if(B){C.stationFor12306.setStationInCookies(S[1],S[2])}C("#form_cities").css("display","none");C("#form_cities2").css("display","none");C("#form_cities3").css("display","none");m=-1;y=0;C.stationFor12306.setStationStyle();if(L){C.stationFor12306.LoadJS(S[2])}if(J){J(I,curObjCode)}},city_shiftSelect:function(k){if(v!=k){if(v!=0){C(v).removeClass("citylineover").addClass("cityline").css("backgroundColor","white")}if(k!=0){try{v=k;var i=C(v).removeClass("cityline").addClass("citylineover").css("backgroundColor","#c8e3fc");A=Number(i.attr("id").split("_")[1]);S=w[Number(i.attr("cturn"))];C("#cityid").val(S[2])}catch(W){}}}},city_shiftSelectInLi:function(i){if(y!=i){if(y!=0){C(y).removeClass("ac_over").addClass("ac_odd")}if(i!=0){try{y=i;C(y).removeClass("ac_odd").addClass("ac_over")}catch(k){}}}},js:function(W){var k;for(k=1;k<=7;k++){if(C("#nav_list"+k).attr("class")){C("#ul_list"+k).css("display","none");C("#nav_list"+k).removeClass("action")}}for(k=1;k<=7;k++){if(k==W){C("#ul_list"+k).css("display","block");C("#nav_list"+k).addClass("action");if(k==1||k==7){C("#flip_cities2").css("display","none")}if(k>1&&k<7){var Y=C.stationFor12306.tHtmlGetCityName(W-1,-1,0);if(Y>u){var X=Math.ceil(Y/u);if(X>1){C.stationFor12306.pageDesigh(X,0,k)}C("#flip_cities2").css("display","block")}else{C("#flip_cities2").css("display","none")}}else{I.focus()}}else{C("#ul_list"+k).css("display","none");C("#nav_list"+k).removeClass("action")}}if(1!=W){C(".ac_even").on("mouseover",function(){C.stationFor12306.city_shiftSelectInLi(this)}).on("click",function(){I.val(C(this).text());curObjCode.val(C(this).attr("data"));if(B){C.stationFor12306.setStationInCookies(C(this).text(),C(this).attr("data"))}C("#form_cities2").css("display","none");m=-1;y=0;C.stationFor12306.setStationStyle();if(L){C.stationFor12306.LoadJS(C(this).attr("data"))}if(J){J(I,curObjCode)}})}},tHtmlGetCityName:function(k,i,X){switch(k){case 0:if(i==-1){return D.length}if(i==-2){return D}return D[i];break;case 1:if(i==-1){return c[3].length}if(i==-2){return f}if(f.length>u){var W=Math.ceil((f.length)/u);if(W>1){t=f.slice(u*(X),Math.min(u*(X+1),f.length));return t[i]}}return f[i];break;case 2:if(i==-1){return c[7].length}if(i==-2){return e}if(e.length>u){var W=Math.ceil((e.length)/u);if(W>1){s=e.slice(u*(X),Math.min(u*(X+1),e.length));return s[i]}}return e[i];break;case 3:if(i==-1){return c[11].length}if(i==-2){return d}if(d.length>u){var W=Math.ceil((d.length)/u);if(W>1){q=d.slice(u*(X),Math.min(u*(X+1),d.length));return q[i]}}return d[i];break;case 4:if(i==-1){return c[18].length}if(i==-2){return b}if(b.length>u){var W=Math.ceil((b.length)/u);if(W>1){p=b.slice(u*(X),Math.min(u*(X+1),b.length));return p[i]}}return b[i];break;case 5:if(i==-1){return c[24].length}if(i==-2){return V}if(V.length>u){var W=Math.ceil((V.length)/u);if(W>1){o=V.slice(u*(X),Math.min(u*(X+1),V.length));return o[i]}}return V[i];break;default:return"error";break}},closeShowCity:function(){C("#form_cities2").css("display","none");m=-1;y=0;C.each(C.stationFor12306.bindInputs,function(Y,X){var W="#"+X;var k="#"+X+"Text";var i=C(k).val();if(""==i){C(k).val(h);C.stationFor12306.from_to_station_class_gray(C(k));C(W).val("")}})},showAllCity:function(){var ab="";var k="440px";if(B){k="400px"}ab='<div class="com_hotresults" id="thetable" style="width:'+k+'"><div style="width:100%;"><div class="ac_title"><span>拼音支持首字母输入</span><a class="ac_close" style="cursor:pointer" title="关闭" onclick="$.stationFor12306.closeShowCity()"></a></div><ul class="AbcSearch clx" id="abc">';if(B){ab=ab+'<li class="action" index="7" method="liHotTab"  onclick="$.stationFor12306.js(7)" id="nav_list7">常用</li>'}ab=ab+'<li index="1" method="liHotTab"  onclick="$.stationFor12306.js(1)" id="nav_list1">热门</li><li index="2" method="liHotTab"  onclick="$.stationFor12306.js(2)" id="nav_list2">ABCDE</li><li index="3" method="liHotTab"  onclick="$.stationFor12306.js(3)" id="nav_list3">FGHIJ</li><li index="4" method="liHotTab"  onclick="$.stationFor12306.js(4)" id="nav_list4">KLMNO</li><li index="5" method="liHotTab"  onclick="$.stationFor12306.js(5)" id="nav_list5">PQRST</li><li index="6" method="liHotTab"  onclick="$.stationFor12306.js(6)" id="nav_list6">UVWXYZ</li></ul>';if(B){ab+='<ul class="popcitylist" style="overflow: auto;max-height: 280px;height: 191px;" method="hotData" id="ul_list7">';var ac=C.stationFor12306.getStationInCookies();var Y=ac.length;if(Y>2){M=true;for(var ad=0;ad<Y;ad++){ab+='<li class="ac_even"   title="'+ac[ad][0]+'" data="'+ac[ad][1]+'">'+ac[ad][0]+"</li>"}}ab+="</ul>"}ab+='<ul class="popcitylist" style="overflow: auto;max-height: 280px;height: 191px;display:none;" method="hotData" id="ul_list1">';var X=C.stationFor12306.tHtmlGetCityName(0,-1,0);var aa="";if(!B){aa=" openLi"}for(var ad=0;ad<X;ad++){ab+='<li class="ac_even'+aa+'"   title="'+C.stationFor12306.tHtmlGetCityName(0,ad,0)[1]+'" data="'+C.stationFor12306.tHtmlGetCityName(0,ad,0)[2]+'">'+C.stationFor12306.tHtmlGetCityName(0,ad,0)[1]+"</li>"}ab+="</ul>";for(var ae=2;ae<=6;ae++){var Z=ae-1;var i=C.stationFor12306.tHtmlGetCityName(Z,-1,0);if(i>u){var W=Math.ceil((i)/u);if(W>1){ab+='<div id="ul_list'+ae+'">';C.stationFor12306.pageDesigh(W,0,ae)}C("#flip_cities2").css("display","block")}else{ab+='<ul  class="popcitylist" style="overflow: auto; max-height: 260px; height: 191px;display:none;" id="ul_list'+ae+'">';C("#flip_cities2").css("display","none");var aa="";if(!B){aa=" openLi"}for(var ad=0;ad<C.stationFor12306.tHtmlGetCityName(Z,-1,0);ad++){ab+='<li class="ac_even'+aa+'"   title="'+C.stationFor12306.tHtmlGetCityName(Z,ad,0)[1]+'" data="'+C.stationFor12306.tHtmlGetCityName(Z,ad,0)[2]+'">'+C.stationFor12306.tHtmlGetCityName(Z,ad,0)[1]+"</li>"}}ab+="</div>"}ab+='<div id="flip_cities2"> 翻页控制区</div>';ab+="</div>";C("#panel_cities2").html(ab);C("#thetable").on("click",function(){if(C("#form_cities2").css("display")=="block"){if(m==1|m==0){m==-1}I.select()}});C("#form_cities").on("click",function(){if(C("#form_cities").css("display")=="block"){if(m==1|m==0){m==-1}I.select()}});C(".ac_even").on("mouseover",function(){C.stationFor12306.city_shiftSelectInLi(this)}).on("click",function(){I.val(C(this).text());curObjCode.val(C(this).attr("data"));if(B){C.stationFor12306.setStationInCookies(C(this).text(),C(this).attr("data"))}C("#form_cities2").css("display","none");m=-1;y=0;C.stationFor12306.setStationStyle();if(L){C.stationFor12306.LoadJS(C(this).attr("data"))}if(J){J(I,curObjCode)}});C("#flip_cities2").css("display","none");return w},LoadJS:function(W){if(((typeof(mm_addjs)!="undefined"))&&(""!=mm_addjs)&&(mm_addjs==1)){var k=document.getElementsByTagName("HEAD").item(0);var i=document.createElement("SCRIPT");i.src=mm_srcjs+W+".js";i.type="text/javascript";k.appendChild(i)}},addZMHtml:function(X,Y){var W="";if(X&&X.length>0){var Z=X[0][0].charAt(0);W+='<ul  class="popcitylist" style="overflow: auto; max-height: 260px; " >';W+='<li class="ac_letter">'+Z.toUpperCase()+"</li>";for(var i=0;i<12;i++){var k=X[i];if(k){W+='<li class="ac_even'+Y+'"   title="'+k[1]+'" data="'+k[2]+'">'+k[1]+"</li>"}else{W+='<li class="ac_even'+Y+'" </li>'}}W+="</ul>"}return W},pageDesigh:function(Z,ac,ad){var W="";if(Z>1){if(ac==-1){ac=(Z-1)}else{if(ac==Z){ac=0}}var ab="";if(!B){ab=" openLi"}for(var X=2;X<=6;X++){if(X==ad){var aa=P[X-2];for(var i=0;i<aa.length;i++){K=aa[i].slice(ac*u,(ac+1)*u);W+=C.stationFor12306.addZMHtml(K,ab)}}}C("#ul_list"+ad).html(W);C("#ul_list"+ad).css("height",270);if(W){var Y=(ac==0)?"&laquo;&nbsp;上一页":"<a style='cursor:pointer'    class='cityflip' onclick='$.stationFor12306.pageDesigh("+Z+","+(ac-1)+","+ad+");return false;'>&laquo;&nbsp;上一页</a>";Y+="&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;";Y+=(ac==Z-1)?"下一页&nbsp;&raquo;":"<a style='cursor:pointer' class='cityflip'  onclick='$.stationFor12306.pageDesigh("+Z+","+(ac+1)+","+ad+")'>下一页&nbsp;&raquo;</a>";C("#flip_cities2").html(Y)}else{C("#flip_cities2").html("")}if(m==1|m==0|m==2){m==-1}if(I){I.select()}}else{}C(".ac_even").on("mouseover",function(){C.stationFor12306.city_shiftSelectInLi(this)}).on("click",function(){I.val(C(this).text());curObjCode.val(C(this).attr("data"));if(B){C.stationFor12306.setStationInCookies(C(this).text(),C(this).attr("data"))}C("#form_cities2").css("display","none");m=-1;y=0;C.stationFor12306.setStationStyle();if(L){C.stationFor12306.LoadJS(C(this).attr("data"))}if(J){J(I,curObjCode)}})},filterCity:function(Z){if(Z.length==0){C("#top_cities").html(n);return w}var Y=/<\/?[^>]*>/g;Z=Z.replace(Y,"");var W=[];var k=/[^A-z]/.test(Z);for(var X=0;X<w.length;X++){if(C.stationFor12306.isMatchCity(w[X],Z,k)){W.push(w[X])}}if(W.length>0){C("#top_cities").html('按"<font color=red>'+Z+'</font>"检索：');return W}else{C("#top_cities").html("无法匹配:<font color=red>"+Z+"</font>");return[]}},replaceChar:function(i,W,k){return i.substr(0,W)+k+i.substr(W+1,i.length-1)},isMatchCity:function(Z,ac,W){var ac=ac.toLowerCase();var k=[Z[4].toLowerCase(),Z[1],Z[3].toLowerCase()];var ab=-1;var Y=-1;if(W){ac=ac.split("");for(var X=0;X<ac.length;X++){var ae=k[1].indexOf(ac[X]);if(ae>ab&&ae<=X){k[1]=C.stationFor12306.replaceChar(k[1],ae,"-");ab=ae}else{return false}}}else{ac=ac.split("");var i=true;var aa=true;for(var X=0;X<ac.length;X++){var ae=k[0].indexOf(ac[X]);if(ae>ab&&ae<=X){k[0]=C.stationFor12306.replaceChar(k[0],ae,"-");ab=ae}else{i=false;break}}for(var X=0;X<ac.length;X++){var ad=k[2].indexOf(ac[X]);if(ad>Y&&ad<=X){k[2]=C.stationFor12306.replaceChar(k[2],ad,"-");Y=ad}else{aa=false;break}}if((i==false)&&(aa==false)){return false}}return true},city_showlist_page:function(ad,Y){var Z="";Z+='<div class="citypage">';Z+=(ad==0)?"":'<a href="#" class="pagetxt" onclick="$.stationFor12306.city_showlist('+(ad-1)+');return false;"><<</a>';var ae=ad+1;var aa=Y;var ab=2;var ac=5;var k=(ae-ab)>0?(ae+ab>aa?aa-ac+1:ae-ab):1;var W=k+ac>aa?aa+1:k+ac;if(aa<ac){for(var X=1;X<aa+1;X++){if(ae==X){Z+="<a href='' class='cur' onclick='$.stationFor12306.city_showlist("+(X-1)+");return false;'>"+(X)+"</a>"}else{Z+="<a href='' onclick='$.stationFor12306.city_showlist("+(X-1)+");return false;'>"+(X)+"</a>"}}}else{for(var X=k;X<W;X++){if(ae==X){Z+="<a href='' class='cur' onclick='$.stationFor12306.city_showlist("+(X-1)+");return false;'>"+(X)+"</a>"}else{Z+="<a href='' onclick='$.stationFor12306.city_showlist("+(X-1)+");return false;'>"+(X)+"</a>"}}}Z+=(ad==Y-1)?"":'<a href="" class="pagetxt" onclick="$.stationFor12306.city_showlist('+(ad+1)+');return false;">>></a>';Z+="</div>";return Z},city_showlist:function(W){if(E.length>6){var k=Math.ceil((E.length)/6);if(W==-1){W=(k-1)}else{if(W==k){W=0}}G=E.slice(6*(W),Math.min(6*(W+1),E.length));C.stationFor12306.city_Bind(G);var i="";i+=C.stationFor12306.city_showlist_page(W,k);C("#flip_cities").html(i);C("#flip_cities").css("display","block")}else{W=0;G=E;C.stationFor12306.city_Bind(G);C("#flip_cities").css("display","none")}z=W;if(C("#form_cities").css("display")=="block"){a=true;I.focus()}},fixDivBugInIE6:function(i){try{i.bgiframe();if(i.width()>C("> ul",i).width()){i.css("overflow","hidden")}else{C("> iframe.bgiframe",i).width(C("> ul",i).width());i.css("overflow","scroll")}if(i.height()>C("> ul",i).height()){i.css("overflow","hidden")}else{C("> iframe.bgiframe",i).height(C("> ul",i).height());i.css("overflow","scroll")}}catch(k){}},clearStation:function(i){m=-1;var W=I.val();var X=curObjCode.val();if(W==""||X==""){I.val("");curObjCode.val("")}else{var k=W+"|"+X;if(typeof(station_names)!="undefined"){if(station_names.indexOf(k)==-1){I.val("");curObjCode.val("")}else{if("click"==i){I.select();if(C("#form_cities").is(":hidden")){C("#form_cities2").css("display","block")}}}}else{I.val("");curObjCode.val("")}}},MapCityID:function(W){for(var k=0;k<w.length;k++){if(w[k][1]==W){return w[k][2]}}return 0},MapCityName:function(k){for(var W=0;W<w.length;W++){if(w[W][2]==k){return w[W][1]}}return""},SetISPos:function(Y){if(Q){Q(C("#form_cities"),C("#form_cities2"))}else{C("#form_cities").css("left",Y.position().left);C("#form_cities").css("top",Y.position().top+Y.height()+12);C("#form_cities2").css("left",Y.position().left);C("#form_cities2").css("top",Y.position().top+Y.height()+12)}var X=Y.offset().top;var i=C("#search_div");var k=C("#choice_div");i.css("top",X);k.css("top",X);var W=Y.offset().left;i.css("left",W);k.css("left",W)},myHandlerFg:function(i){if(i==null){i.keyCode=9}else{if(!i.which&&i.which==13){i.preventDefault()}else{if(i.which&&i.keyCode==13){i.which=9}}}},myHandler2:function(i){if(i==null){i=window.event;i.returnValue=false}else{if(i.which&&i.which==13){var W=document.getElementById("Upload_Data3");if(document.createEvent){var k=document.createEvent("MouseEvents");k.initEvent("click",true,false);W.dispatchEvent(k)}else{if(document.createEventObject){W.fireEvent("onclick")}}}else{if(!i.which&&i.which==13){i.preventDefault()}}}},from_to_station_class_plain:function(i){if(l&&l!=""){i.removeClass(l)}if(r&&r!=""){i.addClass(r)}},from_to_station_class_gray:function(i){if(r&&r!=""){i.removeClass(r)}if(l&&l!=""){i.addClass(l)}},setStationStyle:function(){var i=I.val();if(i==""){I.val(h);C.stationFor12306.from_to_station_class_gray(I);curObjCode.val("")}else{C.stationFor12306.from_to_station_class_plain(I)}},setCurValue:function(){I.val(S[1]);curObjCode.val(S[2])},bindEvent:function(i){var W="#"+i;var k="#"+i+"Text";C(k).keydown(function(Y){I=C(k);curObjCode=C(W);m=0;a=true;L=true;C("#form_cities2").css("display","none");y=0;var X=C(k).width();if(-[1,]){X=X-4}X=X<220?220:X;C("#form_cities").css("width",X);C("#form_cities").css("display","block");C(".AbcSearch li").removeClass("action");C(".popcitylist").css("display","none");if(M&&B){C("#ul_list7").css("display","block");C("#nav_list7").addClass("action")}else{C("#nav_list1").addClass("action");C("#ul_list1").css("display","block")}C("#flip_cities2").css("display","none");C(".ac_even").removeClass("ac_over").addClass("ac_odd");Y=Y||window.event;if(Y.keyCode==40){C.stationFor12306.city_changeSelectIndex(1);C("#form_cities").css("display","block");C.stationFor12306.SetISPos(I);C.stationFor12306.setCurValue()}else{if(Y.keyCode==38){C.stationFor12306.city_changeSelectIndex(-1);C.stationFor12306.setCurValue();C("#form_cities").css("display","block");C.stationFor12306.SetISPos(I)}else{if(Y.keyCode==13){C.stationFor12306.city_confirmSelect();if(document.addEventListener){document.addEventListener("keypress",C.stationFor12306.myHandlerFg,true)}else{evt=window.event;evt.keyCode=9}}}}}).focus(function(){L=true;if(a){C("#form_cities2").css("display","none");y=0;a=false;m=-1}else{if(m==-1){C(".AbcSearch li").removeClass("action");C(".popcitylist").css("display","none");C("#flip_cities2").css("display","none");if(M&&B){C("#ul_list7").css("display","block");C("#nav_list7").addClass("action")}else{C("#nav_list1").addClass("action");C("#ul_list1").css("display","block")}C(".ac_even").removeClass("ac_over").addClass("ac_odd");C("#form_cities2").css("display","block");for(var X=2;X<=6;X++){C("#ul_list"+X).css("height",0)}}}I=C(k);curObjCode=C(W);m=0;U=true;C.stationFor12306.SetISPos(I)}).blur(function(){I=C(k);curObjCode=C(W);m=0;a=false;L=true;if(!g&&!H){C.stationFor12306.clearStation("blur");U=false;C("#form_cities").css("display","none");C("#form_cities2").css("display","none");m=-1;y=0;E=C.stationFor12306.filterCity("");C.stationFor12306.city_showlist(0);C.stationFor12306.setStationStyle()}}).keyup(function(X){I=C(k);curObjCode=C(W);m=0;a=true;X=X||window.event;if(X.keyCode!=40&&X.keyCode!=38&&X.keyCode!=37&&X.keyCode!=39&&X.keyCode!=13&&X.keyCode!=9){E=C.stationFor12306.filterCity(I.val());C.stationFor12306.city_showlist(0)}}).click(function(){C.stationFor12306.clearStation("click")});C.stationFor12306.bindInputs.push(i)},getStationInCookies:function(){var W=[];var k=C.ht_getcookie("_city_name_save_station");if(k){var i=k.split(",");if(i&&i.length>0){C.each(i,function(aa,Z){var X=Z.split("#");var Y=[];Y[0]=X[0];Y[1]=X[1];W[aa]=Y})}}return W},setStationInCookies:function(af,W){var ac=C.stationFor12306.getStationInCookies();var Z=[];var ag=ac.length;var Y=true;var ah=10;for(var aa=0;aa<ag;aa++){if(ac[aa][0]==af&&ac[aa][1]==W){Y=false}Z.push(ac[aa])}if(Y){Z.push([af,W])}var ab=Z;var X="";var ad=ab.length;var aa=0;if(ad>ah){aa=1}var i=aa;if(ad>1){C("#ul_list7").html("");M=true}var ae="";for(;aa<ad;aa++){if(aa>i){X+=","}X+=ab[aa][0]+"#"+ab[aa][1];if(M&&B){ae+='<li class="ac_even" onmouseover="$.stationFor12306.city_shiftSelectInLi(this);" onclick="$.stationFor12306.li_click(this);"   title="'+ab[aa][0]+'" data="'+ab[aa][1]+'">'+ab[aa][0]+"</li>"}}if(M&&B){C("#ul_list7").html(ae)}C.ht_setcookie("_city_name_save_station",X,365*24*60*60)},li_click:function(i){I.val(C(i).text());curObjCode.val(C(i).attr("data"));if(B){C.stationFor12306.setStationInCookies(C(i).text(),C(i).attr("data"))}C("#form_cities2").css("display","none");m=-1;y=0;C.stationFor12306.setStationStyle();if(L){C.stationFor12306.LoadJS(C(i).attr("data"))}if(J){J(I,curObjCode)}},init:function(ac,ad){if(typeof(ad)!="undefined"){if(typeof(ad._init_input)!="undefined"){h=ad._init_input}if(typeof(ad._top_4_initInput)!="undefined"){n=ad._top_4_initInput}if(typeof(ad.confirmCallBack)!="undefined"){J=ad.confirmCallBack}if(typeof(ad._selected_class)!="undefined"){r=ad._selected_class}if(typeof(ad._unselected_class)!="undefined"){l=ad._unselected_class}if(typeof(ad._12306_openFavorite)!="undefined"){B=ad._12306_openFavorite}if(typeof(ad.position)!="undefined"){Q=ad.position}}if(typeof(station_names)!="undefined"){var Z=station_names.split("@");for(var Y=0;Y<Z.length;Y++){var ab=Z[Y];var aa=ab.toString().charAt(0);for(var X in F){if(aa==F[X]){c[X].push(ab.split("|"))}}if(ab.length>0){ab=ab.split("|");if(O!=""&&ab[2]==O){favcity=ab;w.unshift(ab);if(Y>6){w.push(ab)}}else{w.push(ab)}}}f=c[0].concat(c[1]).concat(c[2]).concat(c[3]).concat(c[4]);e=c[5].concat(c[6]).concat(c[7]).concat(c[8]).concat(c[9]);d=c[10].concat(c[11]).concat(c[12]).concat(c[13]).concat(c[14]);b=c[15].concat(c[16]).concat(c[17]).concat(c[18]).concat(c[19]);V=c[20].concat(c[21]).concat(c[22]).concat(c[23]).concat(c[24]).concat(c[25]);P[0]=[c[0],c[1],c[2],c[3],c[4]];P[1]=[c[5],c[6],c[7],c[8],c[9]];P[2]=[c[10],c[11],c[12],c[13],c[14]];P[3]=[c[15],c[16],c[17],c[18],c[19]];P[4]=[c[20],c[22],c[23],c[24],c[25]];for(var Y=0;Y<w.length;Y++){w[Y].push(Y)}}if(typeof(favorite_names)!="undefined"){var W=favorite_names.split("@");for(var Y=0;Y<W.length;Y++){var ab=W[Y];if(ab.length>0){ab=ab.split("|");D.push(ab)}}for(var Y=0;Y<D.length;Y++){D[Y].push(Y)}}E=C.stationFor12306.filterCity("");C.stationFor12306.city_showlist(0);C.stationFor12306.showAllCity();a=false;C.stationFor12306.fixDivBugInIE6(C("#form_cities"));C.stationFor12306.fixDivBugInIE6(C("#form_cities2"));if(ac&&ac.length>0){C.each(ac,function(k,i){C.stationFor12306.bindEvent(i)})}C("#form_cities").mousedown(function(){g=true}).mouseup(function(){g=false});C("#form_cities2").mousedown(function(){H=true}).mouseup(function(){H=false})}}})(jQuery);
(function(){$.stopStation=function(a){var b=this;b.init=function(){b.options=$.extend({},$.stopStation.defaultOptions,a);if(null==b.options.url||null==b.options.getSearchDate){throw"error options,url can not be null"}b.options.mouseOnPanel=0;if(!$("#"+b.options.showDivId)[0]){var d=[];var c=-1;d[++c]='<div class="station" style="display:none;" id="'+b.options.showDivId+'"><b></b>';d[++c]='<div class="station-info" id="'+b.options.showTitleId+'"></div>';d[++c]='<div class="station-hd"><span class="zx">站序</span><span class="zm">站名</span><span class="dzsj">到站时间</span>';d[++c]='<span class="cfsj">出发时间</span><span class="tlsj">停留时间</span>';d[++c]='<a id="_stopStation_close_id" class="close" title="关闭" href="javascript:" </a></div>';d[++c]='<div class="station-bd"><table><tbody id="'+b.options.showTableId+'"></tbody></table></div></div>';$(d.join("")).appendTo($("body:eq(0)"));$("#_stopStation_close_id").on("click",b.close)}$("#"+b.options.showDivId).css("z-index","20001");if(b.options.mouseOutClose){$("#"+b.options.showDivId).on("mouseenter",function(e){b.options.mouseOnPanel=1}).on("mouseleave",function(){b.options.mouseOnPanel=0;$("#"+b.options.showDivId).hide().appendTo($("body:eq(0)"));$("#"+b.options.showTableId).html("")})}};b.close=function(){$("#"+$.stopStation.defaultOptions.showDivId).closest("tr").removeAttr("style");$("#"+$.stopStation.defaultOptions.showDivId).removeAttr("style");b.options.mouseOnPanel=0;$("#"+$.stopStation.defaultOptions.showDivId).hide().appendTo($("body:eq(0)"));$("#"+$.stopStation.defaultOptions.showTableId).html("")};b.open=function(f,j,h,e,i,c){$("#"+$.stopStation.defaultOptions.showDivId).attr("style","z-index:20001");if(a.timer){clearTimeout(a.timer)}var g=a.getSearchDate();if(i&&""!=i&&null!=i){var d=formatDate(i);if("-"!=d){g=formatDate(i)}else{g=a.getSearchDate()}}else{g=a.getSearchDate()}$.ajax({url:a.url,type:"get",isTakeParam:false,beforeSend:function(k){k.setRequestHeader("If-Modified-Since","0");k.setRequestHeader("Cache-Control","no-cache")},data:{train_no:j,from_station_telecode:h,to_station_telecode:e,depart_date:g},success:function(p){var t=p.data.data;if(t&&t.length>0){var r=[];var u=-1;for(var q=0;q<t.length;q++){var l=t[q];if(q==0){var n=null;n=l.train_class_name;var s=l.service_type;if("0"==s){c="无空调"}else{c="有空调"}if(!n){n="&nbsp;&nbsp;"}$("#"+$.stopStation.defaultOptions.showTitleId).html('<span class="item1">'+l.station_train_code+'次      </span><span class="item2">'+l.start_station_name+"<em>--></em>"+l.end_station_name+'</span><span class="item3">'+n+'</span><span class="item4">'+c+"</span>").find("span").css("color","#333")}var m="";if(!l.isEnabled){m=" style='color: #999;' "}r[++u]='<tr><td width="50" class="tc" '+m+">"+l.station_no+"</td>";r[++u]='<td width="75" '+m+">"+l.station_name+"</td>";r[++u]='<td width="75" '+m+">"+l.arrive_time+"</td>";r[++u]='<td width="75" '+m+">"+l.start_time+"</td>";r[++u]="<td "+m+">"+l.stopover_time+"</td></tr>"}$("#"+$.stopStation.defaultOptions.showTableId).html(r.join(""));var o=$("#"+$.stopStation.defaultOptions.appendTo+f);$("#"+$.stopStation.defaultOptions.showDivId).appendTo(o).show();$(".ticket-info").filter("div").attr("style","");o[0].style["z-index"]=19999;if(!(navigator.appVersion.indexOf("MSIE 6")>-1)){}else{}}}})};b.init();myStopStation=b;return b};$.fn.stopStation=function(){return(new $.stopStation(Array.prototype.slice.call(arguments)[0]))};$.stopStation.defaultOptions={url:null,mouseOutClose:false,showDivId:"train_div_",showTableId:"train_table_",showTitleId:"train_span_",appendTo:"train_num_",getSearchDate:null}})();var myStopStation=function(){};var formatDate=function(b){if(b&&(b.length==8)){var c=b.substring(0,4);var d=b.substring(4,6);var a=b.substring(6,8);return c+"-"+d+"-"+a}else{return"-"}};
var checkusermdId;var showTrainStop;var hideTrainStop;var isInitQueryInput=false;var isInitStationDiv=false;var isInitJsrenderTemplate=false;var isInitDateRange=false;var tickets_info;var location_code;var md5Str;var leftTicketStr;var isAsync;refreshImg=function(d,b,a){var g="img-check";if("undefined"==typeof(a)){a="img_rand_code"}else{g="img-check2"}$("#"+a).attr("src",ctx+"passcodeNew/getPassCodeNew?module="+d+"&rand="+b+"&"+Math.random());var c=$("#"+g).html();$("#"+g).html(c);try{$("#i-ok").hide();if($("#i-ok2")[0]){$("#i-ok2").hide()}$("#randCode").val("");$("#randCode").removeClass("error");if($("#randCode2")[0]){$("#randCode2").val("")}}catch(f){}};var countDown=null;var ischeckAutoSubmitCode=false;var firstShow=1;var endShow=20;var dataNumber=0;var change_dates_arr=[];(function(){var s;var av=null;var bi;var a9;var aM;var bg;var O;var az;var ah=false;var bk=0;var Q;var Y;var k;var b;var g;var aO=new Array();var bh=new Array();var bt=new Array();var t=new Array();var bA=new Array();var aX;var al=new Array();var bn;tickets_info=new Array();var ae=true,be=true,aH=true,ao="starttime";var ad=true;var x=[];var ac=[];var bz=[];var bl;var bf=[];var N="";var by=null;$(document).ready(function(){$.init_ul4li();bj();u();q();aa();aA();V();ag();clickCheckBoxName();e();bv();Z();au();aK();a1();aL();$("#float").headerFloat();$(window).scroll(function(){if(av!=null&&(!av.isHidden())){$("#floatTable").hide();$(window).scrollTop(s)}});$.stopStation({url:ctx+"czxx/queryByTrainNo",getSearchDate:function(){return $.trim($("#train_date").val())}});T();X();a2();aG();_initGuideShow(2);aE();if("Y"==openRandCodeCheck){$("#randCodeLi").show();$("#randCode").on("keyup",function(bB){bB=bB||window.event;if(bB.keyCode==13){}if($("#randCode").val().length==4&&by!=$("#randCode").val()){$.ajax({url:ctx+"passcodeNew/checkRandCodeAnsyn",type:"post",data:{randCode:$("#randCode").val(),rand:"sjrand"},async:false,success:function(bC){if(bC.data.result!="1"){$("#randCode_span").removeClass("i-ok")}else{$("#randCode").removeClass("error");$("#randCode_span").addClass("i-ok")}}})}else{if($("#randCode").val().length!=4){$("#randCode").addClass("error");$("#randCode_span").removeClass("i-ok")}}by=$("#randCode").val()}).on("blur",function(){if($("#randCode").val()==""||$("#randCode").val().length!=4){$("#randCode").addClass("error")}})}});function G(){if(rqChecked.length==0){rqChecked.push($("#train_date").val())}}function bs(){if(!isInitStationDiv){v();isInitStationDiv=true}if(!isInitJsrenderTemplate){aP();isInitJsrenderTemplate=true}}function T(){$("#fromStationText").mouseover(bs);$("#toStationText").mouseover(bs);$("#dc").mouseover(bs);$("#wf").mouseover(bs);$("#dc_label").mouseover(bs);$("#wf_label").mouseover(bs);$("#train_date").mouseover(bs);$("#back_train_date").mouseover(bs);$("#date_range").mouseover(bs)}function a8(bB){f();var bE=bA.length;var bD=new Array();bD.push('<tbody id="queryLeftTable">');for(var bC=0;bC<bB.length;bC++){bD.push('<tr id="ticket_');bD.push(bB[bC].queryLeftNewDTO.train_no);bD.push('" class="');bD.push(bC%2?'">':'bgc">');bD.push('<td colspan="4" width="370">');bD.push('<div class="ticket-info clearfix" id="train_num_');bD.push(bC);bD.push('">');bD.push('<div class="train" id="ticket_');bD.push(bB[bC].queryLeftNewDTO.train_no);bD.push('_train">');bD.push('<div><a title="点击查看停靠站信息" href="javascript:" id="');bD.push(bB[bC].queryLeftNewDTO.train_no);bD.push("_");bD.push(bB[bC].queryLeftNewDTO.from_station_telecode);bD.push("_");bD.push(bB[bC].queryLeftNewDTO.to_station_telecode);if("1"==bB[bC].queryLeftNewDTO.controlled_train_flag||"2"==bB[bC].queryLeftNewDTO.controlled_train_flag){bD.push('" class="number"');bD.push(">")}else{bD.push('" class="number"  onclick="myStopStation.open(\'');bD.push(bC);bD.push("','");bD.push(bB[bC].queryLeftNewDTO.train_no);bD.push("','");bD.push(bB[bC].queryLeftNewDTO.from_station_telecode);bD.push("','");bD.push(bB[bC].queryLeftNewDTO.to_station_telecode);bD.push("','");bD.push(bB[bC].queryLeftNewDTO.start_train_date);bD.push("','");bD.push(bB[bC].queryLeftNewDTO.train_seat_feature);bD.push("');\">")}bD.push(bB[bC].queryLeftNewDTO.station_train_code);bD.push("</a>");if(bB[bC].queryLeftNewDTO.is_support_card!=0&&0==bB[bC].queryLeftNewDTO.controlled_train_flag){bD.push(' <span class="i-card" style="top:12px;" title="可凭二代身份证直接进出站"></span>')}bD.push("</div>");bD.push('<span id="');bD.push(bB[bC].queryLeftNewDTO.train_no);bD.push("_");bD.push(bB[bC].queryLeftNewDTO.from_station_no);bD.push("_");bD.push(bB[bC].queryLeftNewDTO.to_station_no);bD.push("_");bD.push(bB[bC].queryLeftNewDTO.yp_info);bD.push("_");bD.push(bB[bC].queryLeftNewDTO.seat_types);bD.push('" class="lookup"></span>');bD.push("</div>");bD.push('<div class="cdz">');if(bB[bC].queryLeftNewDTO.from_station_telecode!=null&&bB[bC].queryLeftNewDTO.from_station_telecode==bB[bC].queryLeftNewDTO.start_station_telecode){bD.push('<strong class="start-s">');bD.push(bB[bC].queryLeftNewDTO.from_station_name);bD.push("</strong>")}else{bD.push("<strong>");bD.push(bB[bC].queryLeftNewDTO.from_station_name);bD.push("</strong>")}if(bB[bC].queryLeftNewDTO.to_station_telecode!=null&&bB[bC].queryLeftNewDTO.to_station_telecode==bB[bC].queryLeftNewDTO.end_station_telecode){bD.push('<strong class="end-s">');bD.push(bB[bC].queryLeftNewDTO.to_station_name);bD.push("</strong>")}else{bD.push("<strong>");bD.push(bB[bC].queryLeftNewDTO.to_station_name);bD.push("</strong>")}bD.push("</div>");bD.push('<div class="cds">');if("1"==bB[bC].queryLeftNewDTO.controlled_train_flag||"2"==bB[bC].queryLeftNewDTO.controlled_train_flag){bD.push('<strong class="start-t" style="color:#999;">');bD.push("-----");bD.push("</strong>");bD.push('<strong class="color999">');bD.push("-----");bD.push("</strong>")}else{bD.push('<strong class="start-t">');bD.push(bB[bC].queryLeftNewDTO.start_time);bD.push("</strong>");bD.push('<strong class="color999">');bD.push(bB[bC].queryLeftNewDTO.arrive_time);bD.push("</strong>")}bD.push("</div>");bD.push('<div  class="ls" ');bD.push('id="');bD.push(bB[bC].queryLeftNewDTO.train_no);bD.push('_ls">');if("1"==bB[bC].queryLeftNewDTO.controlled_train_flag||"2"==bB[bC].queryLeftNewDTO.controlled_train_flag){bD.push('<strong class="color999">');bD.push("------");bD.push("</strong>");bD.push('<strong class="color999">');bD.push("------");bD.push("</strong>")}else{bD.push("<strong>");bD.push(bB[bC].queryLeftNewDTO.lishi);bD.push("</strong>");bD.push("<span>");bD.push(changeArriveDate(bB[bC].queryLeftNewDTO.start_time,bB[bC].queryLeftNewDTO.lishi));bD.push("到达</span>")}bD.push("</div>");bD.push("</div>");bD.push("</td>");W(bD,bB[bC].queryLeftNewDTO.swz_price,"SWZ_",bB[bC].queryLeftNewDTO.train_no,bB[bC].queryLeftNewDTO.yp_ex,"91",bB[bC].queryLeftNewDTO.controlled_train_flag);W(bD,bB[bC].queryLeftNewDTO.tz_price,"TZ_",bB[bC].queryLeftNewDTO.train_no,bB[bC].queryLeftNewDTO.yp_ex,"P1",bB[bC].queryLeftNewDTO.controlled_train_flag);W(bD,bB[bC].queryLeftNewDTO.zy_price,"ZY_",bB[bC].queryLeftNewDTO.train_no,bB[bC].queryLeftNewDTO.yp_ex,"M1",bB[bC].queryLeftNewDTO.controlled_train_flag);W(bD,bB[bC].queryLeftNewDTO.ze_price,"ZE_",bB[bC].queryLeftNewDTO.train_no,bB[bC].queryLeftNewDTO.yp_ex,"O1",bB[bC].queryLeftNewDTO.controlled_train_flag);W(bD,bB[bC].queryLeftNewDTO.gr_price,"GR_",bB[bC].queryLeftNewDTO.train_no,bB[bC].queryLeftNewDTO.yp_ex,"61",bB[bC].queryLeftNewDTO.controlled_train_flag);W(bD,bB[bC].queryLeftNewDTO.rw_price,"RW_",bB[bC].queryLeftNewDTO.train_no,bB[bC].queryLeftNewDTO.yp_ex,"41",bB[bC].queryLeftNewDTO.controlled_train_flag);W(bD,bB[bC].queryLeftNewDTO.yw_price,"YW_",bB[bC].queryLeftNewDTO.train_no,bB[bC].queryLeftNewDTO.yp_ex,"31",bB[bC].queryLeftNewDTO.controlled_train_flag);W(bD,bB[bC].queryLeftNewDTO.rz_price,"RZ_",bB[bC].queryLeftNewDTO.train_no,bB[bC].queryLeftNewDTO.yp_ex,"21",bB[bC].queryLeftNewDTO.controlled_train_flag);W(bD,bB[bC].queryLeftNewDTO.yz_price,"YZ_",bB[bC].queryLeftNewDTO.train_no,bB[bC].queryLeftNewDTO.yp_ex,"11",bB[bC].queryLeftNewDTO.controlled_train_flag);if(bB[bC].queryLeftNewDTO.WZ_num!="--"){W(bD,bB[bC].queryLeftNewDTO.wz_price,"WZ_",bB[bC].queryLeftNewDTO.train_no,bB[bC].queryLeftNewDTO.yp_ex,"W1",bB[bC].queryLeftNewDTO.controlled_train_flag)}bD.push(' <td width="46" align="center" id="');bD.push("QT_");bD.push(bB[bC].queryLeftNewDTO.train_no);bD.push('">');bD.push("--");bD.push("</td>");if("1"==bB[bC].queryLeftNewDTO.controlled_train_flag||"2"==bB[bC].queryLeftNewDTO.controlled_train_flag){bD.push('<td align="center" width="80" class="no-br">');bD.push(bB[bC].queryLeftNewDTO.controlled_train_message);bD.push("</td>")}else{if("Y"==bB[bC].queryLeftNewDTO.canWebBuy){bD.push(' <td align="center" width="80" class="no-br"><a href="javascript:" class="btn72" onclick="submitOrderRequest(\'');bD.push(bB[bC].secretStr);bD.push("','");bD.push(bB[bC].queryLeftNewDTO.start_time);bD.push("')\">");bD.push(buttonText());bD.push("</a>");bD.push("</td>")}else{bD.push('<td align="center" width="80" class="no-br">');bD.push(bB[bC].buttonTextInfo);bD.push("</td>")}}bD.push("</tr>")}bD.push("</tbody>");$("#queryLeftTable").replaceWith(bD.join(""))}function W(bF,bB,bL,bG,bC,bJ,bD){bC=bC.replace("F","4").replace("A","6");var bI=bC?bC.indexOf(bJ):-1;var bH=false;if(bI>-1&&(bI%2)==0){bH=true}if("1"==bD||"2"==bD){bF.push(' <td width="46" align="center" style="cursor: pointer;"  id="');bF.push(bL);bF.push(bG);bF.push('">');bF.push(bB);bF.push("</td>")}else{var bK=bB;var bE="";if("--"!=bK){bB=Number(bK)/10;if(bB<=0){bB="--"}else{if(bB.toString().indexOf(".")<0){bB=bB+".0";bB="&yen;"+bB;bE=" class='yes' "}else{bB="&yen;"+bB;bE=" class='yes' "}}}if(bB&&bB.indexOf("NAN")>=0){bB=""}bF.push(' <td width="46" align="center" '+bE+' id="');bF.push(bL);bF.push(bG);bF.push('">');if(bH){bF.push('<div class="sale" title="本席别票价打折"><span style="font-family: Arial,Simsun;">'+bB+'</span><span class="i-mark">折</span></div>')}else{bF.push('<span style="font-family: Arial,Simsun;">'+bB+"</span>")}bF.push("</td>")}}function bx(bC,bB){ishaveCheckId=false;for(i=0;i<bC.length;i++){if(bC[i][0]==bB){bC[i][1]=$("#".concat($("#".concat(bB)).attr("for"))).is(":checked");ishaveCheckId=true}}if(!ishaveCheckId){bC[bC.length]=[bB,true]}}function aQ(){aD(bi);aD(a9);aD(aM)}function aD(bB){for(i=0;i<bB.length;i++){if(bB[i][1]){$("#".concat(bB[i][0]).concat("_check")).attr("checked",true)}}}function ar(bC){var bB=new Date();var bD=bC.split("-");bB.setFullYear(parseInt(bD[0]),parseInt(bD[1]-1,10),parseInt(bD[2],10));if(bD.length>=6){bB.setHours(bD[3],bD[4],bD[5])}return bB}Date.prototype.format=function(bC){var bD={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};if(/(y+)/.test(bC)){bC=bC.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length))}for(var bB in bD){if(new RegExp("("+bB+")").test(bC)){bC=bC.replace(RegExp.$1,RegExp.$1.length==1?bD[bB]:("00"+bD[bB]).substr((""+bD[bB]).length))}}return bC};$("#train_date").focus(function(){$("#train_date").jcalendar({isSingle:false,startDate:init_minPeriod,endDate:init_maxPeriod,onpicked:function(){if($("#dc").is(":checked")){if(rqChecked.length==0){rqChecked.push(startDate)}var bB=false;if(startDate!=rqChecked[0]){for(var bC=0;bC<rqChecked.length;bC++){if(startDate==rqChecked[bC]){bB=true;rqChecked.splice(bC,1);$("#date-list input[value="+rqChecked[0]+"]").prop("checked",false);rqChecked.splice(0,1,startDate);$("#prior_date span[name="+startDate+"]").remove();break}}if(!bB){$("#date-list input[value="+rqChecked[0]+"]").prop("checked",false);rqChecked.splice(0,1,startDate);$("#date-list input[value="+rqChecked[0]+"]").prop("checked",true)}}}aE();$("#train_date").blur()}})});$("#date_icon_1").click(function(){$("#train_date").focus()});function J(bD,bC){var bB=new Date(Date.parse(bD.replace(/-/g,"/")));bB.setDate(bB.getDate()+bC);return aY(bB)}function aY(bC){var bD=bC.getFullYear();var bF=bC.getMonth()+1;var bE=bC.getDate();var bB=bD+"-"+bF+"-"+bE;return bB}function aw(){var bD=$("#train_date").val();var bC=$("#back_train_date").val();var bB=false;if($("#wf").is(":checked")){if(ar(bD)<=ar(bC)){bB=true}}else{return true}return bB}function aN(){var bE=$.jc_getFromStation();if(bE){var bD=bE.split(",");if(bD&&bD.length==2){$("#fromStationText").val(bD[0]);$("#fromStation").val(bD[1])}}var bC=$.jc_getToStation();if(bC){var bD=bC.split(",");if(bD&&bD.length==2){$("#toStationText").val(bD[0]);$("#toStation").val(bD[1])}}var bF=[];bF=stu_buy_date.split("&");var bB=$.jc_getFromDate();if(bB){if(bB>=bF[0]&&bB<=bF[1]){$("#train_date").val(bB)}}var bG=$.jc_getWfOrDc();if(bG&&"wf"==bG){$("#wf").click();var bH=$.jc_getToDate();if(bH){if(bH>=bF[0]&&bH<=bF[1]){$("#back_train_date").val(bH)}}}else{$("#dc").click()}}function bd(){$("#train_stop").on("mouseover",function(bB){if(checkHover(bB,this)){bk=1}}).on("mouseleave",function(){bk=0;$("#train_stop").hide();$("#train_table_").html("")})}function bj(){fromStation=from_station;fromStationName=from_station_name;toStation=to_station;toStationName=to_station_name;trainDate=trainDate;backTrainDate=backTrainDate;bi=new Array();a9=new Array();aM=new Array()}function a2(){$("#fromStation").val(fromStation);$("#fromStationText").val(fromStationName);$("#toStation").val(toStation);$("#toStationText").val(toStationName);$("#train_date").val(trainDate);if(backTrainDate!=null&&backTrainDate!=""){$("#back_train_date").val(backTrainDate)}if($("#fromStationText").val()==""){$("#fromStationText").val("简拼/全拼/汉字")}if($("#toStationText").val()==""){$("#toStationText").val("简拼/全拼/汉字")}if(page_show_flag==null){aN()}else{if(page_show_flag=="index"){a5()}else{if(page_show_flag=="preStep"){ap()}else{if(page_show_flag=="fcInit"){m()}else{if(page_show_flag=="gcInit"){r()}}}}}}function a5(){if(tour_flag=="wf"){$("#wf").click()}else{if(tour_flag=="dc"){$("#dc").click()}}var bB=[];$("#date_range>ul>li").each(function(){var bC=$(this).children("span:first-child").html();bB.push(bC)});$("#query_ticket").click()}function ap(){$("#fromStationText").removeClass().addClass("inp_selected");$("#toStationText").removeClass().addClass("inp_selected");if(train_tour_flag=="dc"){a0(trainDate);$("#dc").click()}if(train_tour_flag=="wc"){a0(trainDate);$("#wf").click()}if(train_tour_flag=="fc"){a0(backTrainDate);$("#wf").click();$("#wf").attr("disabled","true");$("#dc").attr("disabled","true");$("#change_station").removeClass().addClass("i-change i-change2");$("#change_station").attr("style","");$("#fromStationText").attr("title","返程时不得变更出发地或不能变更到达地");$("#toStationText").attr("title","返程时不得变更出发地或不能变更到达地");$("#toStationText").unbind("focus").unbind("click").attr("readonly","true");$("#fromStationText").unbind("focus").unbind("click").attr("readonly","true");$("#dfc>ul>li:nth-child(2)").children("label:first").removeClass().addClass("color999");$("#dfc>ul>li:nth-child(1)").children("label:first").removeClass().addClass("color999");$("#place_area>ul>li:nth-child(1)").addClass("no-change");$("#place_area>ul>li:nth-child(3)").addClass("no-change");$("#place_area>ul>li:nth-child(4)").addClass("no-change");$("#fromStationText").removeClass().addClass("inp-txt");$("#toStationText").removeClass().addClass("inp-txt");$("#change_station").unbind();$("#train_date").val(trainDate);$("#train_date").attr("readonly","true");$("#train_date").removeClass().addClass("inp-txt");train_date.unload();train_date2.unload();$("#date_area>ul>li:nth-child(1)>span>label").addClass("color999");$("#back_train_date").val(backTrainDate);$("#back_train_date").removeAttr("disabled");$("#date_area>ul>li:nth-child(2)>span>label").removeClass("color999");$("#back_train_date").removeClass().addClass("inp_selected")}if(train_tour_flag=="gc"){a0(trainDate);r()}}function a0(bD){for(var bB=1;bB<=20;bB++){var bC=$("#date_range>ul>li:nth-child("+bB+")").children("span:first-child").text();bC="2013-"+bC;if(bD==bC){$("#date_range>ul>li").removeClass("sel");$("#date_range>ul>li").removeAttr("alt");$("#date_range>ul>li:nth-child("+bB+")").addClass("sel");$("#date_range>ul>li:nth-child("+bB+")").attr("alt","show");$("#date_range>ul>li:nth-child(20)").addClass("end");$("#date_range>ul>li:nth-child("+bB+")").children("span:first-child").removeClass();$("#date_range>ul>li:nth-child("+bB+")").children("span:last-child").removeClass();$("#date_range>ul>li:nth-child("+bB+")").children("span:first-child").addClass("hide");$("#date_range>ul>li:nth-child(1)").children().addClass("first");az=$("#date_range>ul>li:nth-child("+bB+")").children("span:first-child").text();break}}}function r(){$("#fromStationText").attr("title","改签时不得变更出发地或不能变更到达地");$("#toStationText").attr("title","改签时不得变更出发地或不能变更到达地");$("#dc").click();$("#wf").attr("disabled","true");$("#dc").attr("disabled","true");$("#place_area>ul>li:nth-child(1)").addClass("no-change");$("#place_area>ul>li:nth-child(3)").addClass("no-change");$("#place_area>ul>li:nth-child(5)").addClass("no-change");$("#dfc>ul>li:nth-child(1)").children("label:first").removeClass().addClass("color999");$("#dfc>ul>li:nth-child(2)").children("label:first").removeClass().addClass("color999");$("#fromStationText").unbind("focus").unbind("click").attr("readonly","true");$("#toStationText").unbind("focus").unbind("click").attr("readonly","true");$("#fromStationText").removeClass().addClass("inp-txt");$("#toStationText").removeClass().addClass("inp-txt");$("#change_station").unbind();$("#change_station").removeClass().addClass("i-change i-change2");$("#change_station").attr("style","");$("#fromStationText_label").addClass("color999");$("#toStationText_label").addClass("color999")}function m(){$("#fromStationText").attr("title","订返程票时不得变更出发地或不能变更到达地");$("#toStationText").attr("title","订返程票时不得变更出发地或不能变更到达地");a0(backTrainDate);$("#wf").click();$("#dc").attr("disabled","true");$("#wf").attr("disabled","true");$("#place_area>ul>li:nth-child(1)").addClass("no-change");$("#place_area>ul>li:nth-child(3)").addClass("no-change");$("#place_area>ul>li:nth-child(4)").addClass("no-change");$("#dfc>ul>li:nth-child(1)").children("label:first").removeClass().addClass("color999");$("#dfc>ul>li:nth-child(2)").children("label:first").removeClass().addClass("color999");$("#train_date").attr("readonly","true");$("#train_date").addClass("color999");train_date.unload();train_date2.unload();$("#date_area>ul>li:nth-child(1)>span>label").addClass("color999");$("#back_train_date").removeAttr("disabled");$("#date_area>ul>li:nth-child(2)>span>label").removeClass("color999");$("#train_date").removeClass().addClass("inp-txt");$("#back_train_date").removeClass().addClass("inp_selected");$("#fromStationText").unbind("focus").unbind("unfocus").unbind("click").attr("readonly","true");$("#toStationText").unbind("focus").unbind("unfocus").unbind("click").attr("readonly","true");$("#fromStationText").removeClass().addClass("inp-txt");$("#toStationText").removeClass().addClass("inp-txt");$("#change_station").unbind();$("#change_station").removeClass().addClass("i-change i-change2");$("#change_station").attr("style","")}function u(){initPageTitle(3);$("#train_type_btn_all").css("cursor","pointer");$("#start_time_btn_all").css("cursor","pointer");$("#arrive_time_btn_all").css("cursor","pointer");$("#seat_type_btn_all").css("cursor","pointer");$("#from_station_name_all").css("cursor","pointer");$("#to_station_name_all").css("cursor","pointer");$("#change_station").css("cursor","pointer");$("#show_more").css("cursor","pointer");$("#date_normal").css("cursor","pointer");$("#lookup").css("cursor","pointer");$("#s_time").css("cursor","pointer");$("#r_time").css("cursor","pointer");$("#l_s").css("cursor","pointer");$("#other_span_starttime").css("cursor","pointer");$("#other_span_endtime").css("cursor","pointer");$("#other_span_lishi").css("cursor","pointer");$("#date_range>ul>li").children("span:nth-child(1)").css("cursor","pointer");$("#cc_seat_type_btn_all>ul>li").hide();$("#train_date").removeClass().addClass("inp_selected");if($("#fromStationText").val()!=""&&$("#fromStationText").val()!="简拼/全拼/汉字"||$("#toStationText").val()!=""&&$("#toStationText").val()!="简拼/全拼/汉字"){$("#fromStationText").removeClass().addClass("inp_selected");$("#toStationText").removeClass().addClass("inp_selected")}var bB=stu_start_train_date.split("&");var bC=stu_end_tain_date.split("&")}function aW(bC){var bB=("00"+(bC.getMonth()+1)).slice(-2)+"-";bB+=("00"+bC.getDate()).slice(-2)+" 00:00:00";return bB}function V(){$("#train_type_btn_all").click(function(){var bB=true;$("#sear-sel-bd input[name='cc_type']").each(function(){if(!this.checked){bB=false}});if(bB){$("#sear-sel-bd input[name='cc_type']").each(function(){this.checked=false});$("#train_type_btn_all").removeClass().addClass("btn-all")}else{$("#sear-sel-bd input[name='cc_type']").each(function(){if(!this.checked){this.checked=true}});$("#train_type_btn_all").removeClass().addClass("btn-all")}aR()});$("#start_time_btn_all").click(function(){var bB=true;$("#sear-sel-bd input[name='cc_start_time']").each(function(){if(!this.checked){bB=false}});if(bB){$("#sear-sel-bd input[name='cc_start_time']").each(function(){this.checked=false});$("#start_time_btn_all").removeClass().addClass("btn-all")}else{$("#sear-sel-bd input[name='cc_start_time']").each(function(){if(!this.checked){this.checked=true}});$("#start_time_btn_all").removeClass().addClass("btn-all")}aR()});$("#from_station_name_all").click(function(){var bB=true;$("#sear-sel-bd input[name='cc_from_station']").each(function(){if(!this.checked){bB=false}});if(bB){$("#sear-sel-bd input[name='cc_from_station']").each(function(){this.checked=false;bx(bi,"cc_from_station_"+$(this).val())});$("#from_station_name_all").removeClass().addClass("btn-all")}else{$("#sear-sel-bd input[name='cc_from_station']").each(function(){if(!this.checked){this.checked=true;bx(bi,"cc_from_station_"+$(this).val())}});$("#from_station_name_all").removeClass().addClass("btn-all")}aR()});$("#to_station_name_all").click(function(){var bB=true;$("#sear-sel-bd input[name='cc_to_station']").each(function(){if(!this.checked){bB=false}});if(bB){$("#sear-sel-bd input[name='cc_to_station']").each(function(){this.checked=false;bx(a9,"cc_to_station_"+$(this).val())});$("#to_station_name_all").removeClass().addClass("btn-all")}else{$("#sear-sel-bd input[name='cc_to_station']").each(function(){if(!this.checked){this.checked=true;bx(a9,"cc_to_station_"+$(this).val())}});$("#to_station_name_all").removeClass().addClass("btn-all")}aR()})}function bv(){$("#change_station").bind("click",function(){var bF=$("#fromStationText").val();var bH=$("#fromStation").val();var bG=$("#toStationText").val();var bB=$("#toStation").val();if((bF!=""&&bF!="简拼/全拼/汉字")&&(bG!=""&&bG!="简拼/全拼/汉字")){$("#fromStationText").val(bG);$("#toStationText").val(bF);$("#fromStation").val(bB);$("#toStation").val(bH);$("#fromStationText").removeClass().addClass("inp_selected");$("#toStationText").removeClass().addClass("inp_selected")}else{Y.checkForm();Y.hideErrors();var bE=Y.errorList;for(var bD=0;bD<bE.length;bD++){var bC=bE[bD];$(bC.element).next().addClass("error")}Y.checkForm()}aJ()})}function aJ(){if($("#fromStationText").val()=="简拼/全拼/汉字"){$.stationFor12306.from_to_station_class_gray($("#fromStationText"))}else{$.stationFor12306.from_to_station_class_plain($("#fromStationText"))}if($("#toStationText").val()=="简拼/全拼/汉字"){$.stationFor12306.from_to_station_class_gray($("#toStationText"))}else{$.stationFor12306.from_to_station_class_plain($("#toStationText"))}}function e(){$("#show_more").click(function(){if(!$("#show_more").hasClass("open")){am();$("#show_more").addClass("open");$("#show_more").attr("title","收缩")}else{document.getElementById("sear-sel-bd").style.height="17px";$("#show_more").removeClass("open");$("#show_more").attr("title","展开")}})}function af(){if($("#sear-sel-bd").height()!=17){am()}}function am(){var bD="17px";var bF=51;var bE=28;var bB=$("#sear-sel-bd input[name='cc_from_station']").length;var bG=$("#sear-sel-bd input[name='cc_to_station']").length;var bC=$("#sear-sel-bd input[name='cc_seat_type']").length;if(bB>7&&bB<=14){bD=(bF+bE)+"px"}else{if(bG>7&&bB<=14){bD=(bF+bE*2)+"px"}else{if(bC>7){bD=(bF+bE)+"px"}else{bD=bF+"px"}}}document.getElementById("sear-sel-bd").style.height=bD;$("#show_more").attr("title","收缩")}function v(){if(train_tour_flag=="fc"||train_tour_flag=="gc"){return}$.stationFor12306.init(["fromStation","toStation"],{_init_input:"简拼/全拼/汉字",_top_4_initInput:"简拼/全拼/汉字或↑↓",_unselected_class:"inpt_unselected",_selected_class:"inp_selected",confirmCallBack:function(bB){bB.removeClass("error")}});$("#fromStation_icon_image").css("cursor","pointer");$("#toStation_icon_image").css("cursor","pointer");$("#fromStationText_label").click(function(){$("#fromStationText").focus()});$("#toStationText_label").click(function(){$("#toStationText").focus()});$("#fromStation_icon_image").click(function(){$("#fromStationText").focus()});$("#toStation_icon_image").click(function(){$("#toStationText").focus()})}function X(){Y=$("#queryLeftForm").validate({rules:{"leftTicketDTO.from_station":{required:true},"leftTicketDTO.to_station":{required:true},"leftTicketDTO.train_date":{required:true},back_train_date:{required:true}},ignore:"",onsubmit:false,onfocusout:function(){},onkeyup:function(){},onclick:function(){},highlight:function(){},unhighlight:function(){}});ab()}function aT(bB){dhtmlx.alert({title:"提示",ok:messages["button.ok"],text:bB,type:"alert-error",callback:function(){}})}function aB(bC,bI){var bB=Y.checkForm();Y.hideErrors();if(bB){var bH="";if(!aw()){bH="返程日不得小于出发日";aT(bH);return false}var bF=[];if(bI){bF=stu_buy_date.split("&")}else{bF=other_buy_date.split("&")}if(bF.length>0){if(bC<bF[0]||bC>bF[1]){bH="您选择的日期不在预售期范围内！";aT(bH);return false}}}else{var bG=Y.errorList;for(var bE=0;bE<bG.length;bE++){var bD=bG[bE];$(bD.element).next().addClass("error")}return false}a6();return true}function a6(){$.jc_setFromStation($("#fromStationText").val(),$("#fromStation").val());$.jc_setToStation($("#toStationText").val(),$("#toStation").val());$.jc_setFromDate($("#train_date").val());$.jc_setToDate($("#back_train_date").val());$.jc_setWfOrDc($("#wf").is(":checked")?"wf":"dc")}function ab(){$("#query_ticket").click(function(bF){bs();if(myStopStation){myStopStation.close()}var bC=$.trim($("#train_date").val());var bB=aB(bC,false);if(!bB){return}var bD={"leftTicketDTO.train_date":bC,"leftTicketDTO.from_station":$("#fromStation").val(),"leftTicketDTO.to_station":$("#toStation").val(),purpose_codes:"ADULT",randCode:$("#randCode").val()};aE();var bE=$("#randCode").val();if("Y"==openRandCodeCheck){if(""==bE){$("#randCode").addClass("error");return false}if(bE.length!=4){$("#randCode").addClass("error");return false}else{if(!/^[a-zA-Z0-9]+$/.test(bE)){$("#randCode").addClass("error");return false}else{$.ajax({url:ctx+"passcodeNew/checkRandCodeAnsyn",type:"post",data:{randCode:bE,rand:"sjrand"},async:true,success:function(bG){if(bG.data.result!="1"){$("#randCode").addClass("error");$("#randCode").val("");refreshImg("other","sjrand");$("#randCode_span").removeClass("i-ok");return false}else{$("#randCode").removeClass("error");bw(bD)}}})}}}else{bw(bD)}})}function bw(bB){$("#cc_seat_type_btn_all>ul>li").css("display","none");$("#filterTicDiv").html("");bo();var bC=dhtmlx.modalbox({targSrc:'<div><img src="'+ctx+'resources/images/loading.gif"></img></div>',callback:function(){}});$.ajax({type:"get",isTakeParam:false,beforeSend:function(bD){bD.setRequestHeader("If-Modified-Since","0");bD.setRequestHeader("Cache-Control","no-cache")},cache:true,url:ctx+"leftTicketPrice/queryAllPublicPrice",data:bB,timeout:10000,error:function(bD,bF,bE){dhtmlx.modalbox.hide(bC)},success:function(bE){dhtmlx.modalbox.hide(bC);refreshImg("other","sjrand");$("#randCode").val("");$("#randCode").removeClass("error");$("#randCode_span").removeClass("i-ok");if(bE.status){if(bE.data.message){aT(bE.data.message);return}if(bE.data==null||bE.data.length==0){$("#sear-sel").hide();$("#sear-result").hide();$("#t-list").hide();$("#no_filter_ticket_fromstation").html($("#fromStationText").val());$("#no_filter_ticket_tostation").html($("#toStationText").val());$("#no_filter_ticket_2").show();$(".content").css("min-height","344px");return}$("#sear-sel").show();$("#sear-result").show();$("#t-list").show();$("#no_filter_ticket_2").hide();var bD="<strong>".concat($("#fromStationText").val()).concat(" --> ").concat($("#toStationText").val()).concat("（").concat(a7($("#train_date").val())).concat('）</strong>共计<strong id="trainum">').concat(bE.data.length).concat("</strong>个车次");$("#sear-result>p").html(bD);aO=bE.data;bc(aO);af();j(aO);aQ();bq()}}});aZ()}function q(){$("#date_range>ul>li").each(function(bF){var bD=fullDateArr[bF];var bC=new Date(Date.parse(bD.replace(/-/g,"/")));var bE=$("#date_range>ul>li:nth-child("+(bF+1)+")>span[class=hide]").text().substring(0,5)+C(bC);$("#date_range>ul>li:nth-child("+(bF+1)+")>span[class=hide]").text(bE);dates=$(this).children("span:first-child").html();change_dates_arr.push(dates);dataNumber++});if(index_train_date==null){$("#date_range>ul>li:nth-child(1)").addClass("sel");$("#date_range>ul>li:nth-child(1)").attr("alt","show");$("#date_range>ul>li:nth-child(20)").addClass("end");$("#date_range>ul>li:nth-child(1)").children("span:first-child").removeClass();$("#date_range>ul>li:nth-child(1)").children("span:last-child").removeClass();$("#date_range>ul>li:nth-child(1)").children().addClass("first");$("#date_range>ul>li:nth-child(1)").children("span:first-child").addClass("hide");az=$("#date_range>ul>li:nth-child(1)").children("span:first-child").text();for(var bB=endShow+1;bB<=dataNumber;bB++){$("#date_range>ul>li:nth-child("+bB+")").hide()}}c()}function C(bC){var bF=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"];var bE=0;for(var bD=0;bD<bF.length;bD++){if(bC.toString().indexOf(bF[bD])>-1){bE=bD+1;break}}var bB="";switch(bE){case 1:bB=" 周一";break;case 2:bB=" 周二";break;case 3:bB=" 周三";break;case 4:bB=" 周四";break;case 5:bB=" 周五";break;case 6:bB=" 周六";break;case 7:bB=" 周日";break}return bB}function d(){$("#date_range>ul>li").unbind("mouseover");$("#date_range>ul>li").unbind("mouseout");$("#date_range").unbind("mouseleave");$("#date_range>ul>li").unbind("click")}function c(){$("#date_range>ul>li").bind("mouseover",function(){$("#date_range>ul>li").removeClass("sel");$("#date_range>ul>li").removeAttr("alt");$(this).addClass("sel");$(this).attr("alt","show");$("#date_range>ul>li:nth-child("+endShow+")").addClass("end");$(this).children("span:first-child").removeClass();$(this).children("span:last-child").removeClass();$("#date_range>ul>li:nth-child("+firstShow+")").children().addClass("first");$(this).children("span:first-child").addClass("hide")});$("#date_range>ul>li").bind("mouseout",function(){$("#date_range>ul>li").each(function(bB){$(this).children("span:first").removeClass();$("#date_range>ul>li:nth-child("+firstShow+")").children().addClass("first");$(this).children("span:last").addClass("hide")})});$("#date_range").bind("mouseleave",function(){for(var bB=firstShow;bB<=endShow;bB++){var bC=$("#date_range>ul>li:nth-child("+bB+")").children("span:first-child").text();if(az==bC){$("#date_range>ul>li").removeClass("sel");$("#date_range>ul>li").removeAttr("alt");$("#date_range>ul>li:nth-child("+bB+")").addClass("sel");$("#date_range>ul>li:nth-child("+bB+")").attr("alt","show");$("#date_range>ul>li:nth-child("+endShow+")").addClass("end");$("#date_range>ul>li:nth-child("+bB+")").children("span:first-child").removeClass();$("#date_range>ul>li:nth-child("+bB+")").children("span:last-child").removeClass();$("#date_range>ul>li:nth-child("+firstShow+")").children().addClass("first");$("#date_range>ul>li:nth-child("+bB+")").children("span:first-child").addClass("hide");break}}});$("#date_range>ul>li").bind("click",function(){var bC=new Date();var bF="";nowDate=$("#train_date").val();var bG=$(this).children("span:first-child").text();var bB=Number(bG.substring(0,2));var bI=new Date().getMonth();var bE=bC.getFullYear();if(bI>bB){bE=bE+1}$("#train_date").val(bE+"-"+bG);trainDate=bE+"-"+bG;bF=trainDate;if(!aw()){$("#back_train_date").val($("#train_date").val())}var bH=aB(bF,false);if(!bH){return}$("#date_range>ul>li").removeClass("sel");$("#date_range>ul>li").removeAttr("alt");$(this).addClass("sel");$(this).attr("alt","show");$("#date_range>ul>li:nth-child(20)").addClass("end");$(this).children("span:first-child").removeClass();$(this).children("span:last-child").removeClass();$("#date_range>ul>li:nth-child(1)").children().addClass("first");$(this).children("span:first-child").addClass("hide");az=$(this).children("span:first-child").text();var bD={"leftTicketDTO.train_date":bF,"leftTicketDTO.from_station":$("#fromStation").val(),"leftTicketDTO.to_station":$("#toStation").val(),randCode:$("#randCode").val()};var bJ=$("#randCode").val();if("Y"==openRandCodeCheck){if(""==bJ){$("#randCode").addClass("error");return false}if(bJ.length!=4){$("#randCode").addClass("error");return false}else{if(!/^[a-zA-Z0-9]+$/.test(bJ)){$("#randCode").addClass("error");return false}else{$.ajax({url:ctx+"passcodeNew/checkRandCodeAnsyn",type:"post",data:{randCode:bJ,rand:"sjrand"},async:true,success:function(bK){if(bK.data.result!="1"){$("#randCode").addClass("error");$("#randCode").val("");refreshImg("other","sjrand");$("#randCode_span").removeClass("i-ok");return false}else{$("#randCode").removeClass("error");bw(bD)}}})}}}else{bw(bD)}})}function ag(){$("#sear-sel-bd input[name='cc_type']").click(function(){var bB=$("input[name='cc_type']");var bC=$("input[name='cc_type']:checked");if($(this).is(":checked")){if(bB&&bC&&bC.length==bB.length){$("#train_type_btn_all").removeClass().addClass("btn-all")}else{$("#train_type_btn_all").removeClass().addClass("btn-all btn-all-sel")}}else{if(bB&&bC&&bC.length==0){$("#train_type_btn_all").removeClass().addClass("btn-all")}else{$("#train_type_btn_all").removeClass().addClass("btn-all btn-all-sel")}}aR()});$("#sear-sel-bd input[name='cc_start_time']").click(function(){var bB=$("input[name='cc_start_time']");var bC=$("input[name='cc_start_time']:checked");if($(this).is(":checked")){if(bB&&bC&&bC.length==bB.length){$("#start_time_btn_all").removeClass().addClass("btn-all")}else{$("#start_time_btn_all").removeClass().addClass("btn-all btn-all-sel")}}else{if(bB&&bC&&bC.length==0){$("#start_time_btn_all").removeClass().addClass("btn-all")}else{$("#start_time_btn_all").removeClass().addClass("btn-all btn-all-sel")}}aR()});$("#sear-sel-bd input[name='cc_arrive_time']").click(function(){var bB=$("input[name='cc_arrive_time']");var bC=$("input[name='cc_arrive_time']:checked");if($(this).is(":checked")){if(bB&&bC&&bC.length==bB.length){$("#arrive_time_btn_all").removeClass().addClass("btn-all")}else{$("#arrive_time_btn_all").removeClass().addClass("btn-all btn-all-sel")}}else{if(bB&&bC&&bC.length==0){$("#arrive_time_btn_all").removeClass().addClass("btn-all")}else{$("#arrive_time_btn_all").removeClass().addClass("btn-all btn-all-sel")}}aR()});$("#cc_start_time").change(function(){aR()})}function K(bD,bC){if(bC.length==0){return true}for(var bB=0;bB<bC.length;bB++){if(bD.queryLeftNewDTO.station_train_code.substring(0,1)==bC[bB]){return true}if(bC[bB]=="QT"){if(bD.queryLeftNewDTO.station_train_code.substring(0,1)!="G"&&bD.queryLeftNewDTO.station_train_code.substring(0,1)!="D"&&bD.queryLeftNewDTO.station_train_code.substring(0,1)!="C"&&bD.queryLeftNewDTO.station_train_code.substring(0,1)!="T"&&bD.queryLeftNewDTO.station_train_code.substring(0,1)!="K"&&bD.queryLeftNewDTO.station_train_code.substring(0,1)!="Z"){return true}}if(bC[bB]=="G"){if(bD.queryLeftNewDTO.station_train_code.substring(0,1)=="C"||bD.queryLeftNewDTO.station_train_code.substring(0,1)=="G"){return true}}}return false}function bu(bE,bG){if(bG.length==0){return true}for(var bB=0;bB<bG.length;bB++){var bF=(bE.queryLeftNewDTO.start_time.replace(":",""));var bC=Number(bG[bB].substring(0,4));var bD=Number(bG[bB].substring(4,8));if(bF>=bC&&bF<=bD){return true}}return false}function an(bD,bB){if(bB.length==0){return true}for(var bC=0;bC<bB.length;bC++){if(bB[bC]=="SWZ"){if(bD.queryLeftNewDTO.swz_num!="--"&&bD.queryLeftNewDTO.swz_num!="无"){al.push("SWZ");return true}}if(bB[bC]=="TZ"){if(bD.queryLeftNewDTO.tz_num!="--"&&bD.queryLeftNewDTO.tz_num!="无"){al.push("TZ");return true}}if(bB[bC]=="ZY"){if(bD.queryLeftNewDTO.zy_num!="--"&&bD.queryLeftNewDTO.zy_num!="无"){al.push("ZY");return true}}if(bB[bC]=="ZE"){if(bD.queryLeftNewDTO.ze_num!="--"&&bD.queryLeftNewDTO.ze_num!="无"){al.push("ZE");return true}}if(bB[bC]=="GR"){if(bD.queryLeftNewDTO.gr_num!="--"&&bD.queryLeftNewDTO.gr_num!="无"){al.push("GR");return true}}if(bB[bC]=="RW"){if(bD.queryLeftNewDTO.rw_num!="--"&&bD.queryLeftNewDTO.rw_num!="无"){al.push("RW");return true}}if(bB[bC]=="YW"){if(bD.queryLeftNewDTO.yw_num!="--"&&bD.queryLeftNewDTO.yw_num!="无"){al.push("YW");return true}}if(bB[bC]=="RZ"){if(bD.queryLeftNewDTO.rz_num!="--"&&bD.queryLeftNewDTO.rz_num!="无"){al.push("RZ");return true}}if(bB[bC]=="YZ"){if(bD.queryLeftNewDTO.yz_num!="--"&&bD.queryLeftNewDTO.yz_num!="无"){al.push("YZ");return true}}if(bB[bC]=="WZ"){if(bD.queryLeftNewDTO.wz_num!="--"&&bD.queryLeftNewDTO.wz_num!="无"){al.push("WZ");return true}}}return false}function p(bC,bB){if(bB.length==0){return true}for(var bD=0;bD<bB.length;bD++){if(bB[bD]==bC.queryLeftNewDTO.from_station_name){return true}}return false}function a(bB,bC){if(bC.length==0){return true}for(var bD=0;bD<bC.length;bD++){if(bC[bD]==bB.queryLeftNewDTO.to_station_name){return true}}return false}function a4(bC,bB){if(bB.length==0){return true}for(var bD=0;bD<bB.length;bD++){if(bB[bD].toLowerCase()==bC.queryLeftNewDTO.station_train_code.toLowerCase()){return true}}return false}function aS(){var bC=[];var bI=[];var bE=[];var bG=[];$("#sear-sel-bd input[name='cc_type']").each(function(){if(this.checked==true){bC.push($(this).val())}});bI.push($("#cc_start_time option:selected").val());$("#sear-sel-bd input[name='cc_from_station']").each(function(){if(this.checked==true){bE.push($(this).val())}});$("#sear-sel-bd input[name='cc_to_station']").each(function(){if(this.checked==true){bG.push($(this).val())}});var bD=aO;var bH=[];if(bC.length>0||bI.length>0||filteredTrainArriveTime.length>0||bz.length>0||bE.length>0||bG.length>0||Q.getComboText()!=""){for(var bB=0;bB<bD.length;bB++){var bF=bD[bB];if(!K(bF,bC)){continue}if(!bu(bF,bI)){continue}if(!p(bF,bE)){continue}if(!a(bF,bG)){continue}bH.push(bF)}bD=bH}return bD}function L(bB,bC){if(bC==null||bC==""||bB.length==0||bC.length>bB.length){return false}if(bB.substr(0,bC.length)==bC){return true}else{return false}return true}function S(bB){ac=ccSelected;bz=xbChecked;if(a4(bB,ac)&&an(bB,bz)){return true}else{return false}}function f(){bA=[];bh=aS();bt=h(bh);for(var bB=0;bB<bt.length;bB++){var bC=bt[bB];if(!S(bC)){continue}if(bC.queryLeftNewDTO.canWebBuy=="Y"){bA.push(bC)}}}var by;function aL(){if(ischeckAutoSubmitCode){$("#randCode2").on("keyup",function(bB){if($("#randCode2").val().length==4&&by!=$("#randCode2").val()){$.ajax({url:ctx+"passcodeNew/checkRandCodeAnsyn",type:"post",data:{randCode:$("#randCode2").val(),rand:"sjrand"},async:false,success:function(bC){if(bC.data.result!="1"){$("#randCode2").removeClass("inptxt w100").addClass("inptxt w100 error");$("#c_error2").html("验证码不合法");$("#randCode2").val("");$("#c_error2").addClass("error");$("#i-ok2").css("display","none");$("#c_error2").css("margin-left","15px")}else{$("#randCode2").removeClass("inptxt w100 error").addClass("inptxt w100");$("#i-ok2").css("display","block");$("#c_error2").html("");$("#c_error2").removeClass("error")}}})}else{if($("#randCode2").val().length!=4){$("#randCode2").removeClass("inptxt w100").addClass("inptxt w100 error");$("#c_error2").html("请输入四位长度验证码");$("#c_error2").addClass("error");$("#i-ok2").css("display","none");$("#c_error2").css("margin-left","15px")}}by=$("#randCode2").val()})}}function br(bB){return bl.autoSubmit(bA,passengerChecked,xbChecked,ccSelected)}var P=false;function bq(){$("#queryLeftTable").html("");$("#trainum").html("");f();if($("#auto_query").is(":checked")){if(bt.length<0){$("#no_filter_ticket").show();$("#trainum").html("0");P=true}else{if(bA.length>0){$("#no_filter_ticket").hide();if(document.getElementById("autoSubmit").checked){var bC=[];for(var bB=0;bB<passengerChecked.length;bB++){var bI=false;var bH=passengerChecked[bB];for(var bE=0;bE<bC.length;bE++){var bG=bC[bE];if(bH.passenger_name==bG.passenger_name&&bH.passenger_id_type_code==bG.passenger_id_type_code&&bH.passenger_id_no==bG.passenger_id_no){bI=true;break}}if(!bI){bC.push(bH)}}passengerChecked=bC;var bF=br(true);if(bF[0]==1||bF[0]==2){P=true;aX=bF[1];y();var bD="ADULT";if($("#sf2").is(":checked")){bD="0X00"}$.ajax({type:"post",url:ctx+"confirmPassenger/autoSubmitOrderRequest",data:{secretStr:aX.secretStr,train_date:$("#train_date").val(),tour_flag:"dc",purpose_codes:bD,query_from_station_name:$("#fromStationText").val(),query_to_station_name:$("#toStationText").val(),passengerSelectList:passengerChecked},success:function(bK){if(bK.status){if(bK.data&&undefined!=bK.data.result&&typeof(bK.data.result)!="undefined"){var bJ=bK.data.result;location_code=bJ.split("#")[0];md5Str=bJ.split("#")[1];leftTicketStr=bJ.split("#")[2];isAsync=bJ.split("#")[3];z();aV(bF);$("#i-ok2").hide();refreshImg("other","sjrand","img_rand_code2");$("#randCode2").val("");$("#c_error2").val("");$("#c_error2").removeClass("error");var bL=dhtmlx.createWin({winId:"autosubmitcheckticketinfo",closeWinId:["back_edit"],okId:"qr_submit",okCallBack:function(){if(isAsync==ticket_submit_order.request_flag.isAsync){I()}else{F()}},checkConfirm:function(){if(!ischeckAutoSubmitCode){return true}randCode=$("#randCode2").val();var bM=true;if(""==randCode){bM=false;$("#randCode2").removeClass("inptxt w100").addClass("inptxt w100 error");$("#c_error2").html(login_messages.randCodeEmpty).attr("class","error").css("margin-left","60px");$("#randCode2").focus()}else{if(!/^[a-zA-Z0-9]+$/.test(randCode)){bM=false;$("#randCode2").removeClass("inptxt w100").addClass("inptxt w100 error");$("#c_error2").html(login_messages.randCodeFormat).attr("class","error").css("margin-left","60px");$("#randCode2").focus()}else{if(randCode.length!=4){bM=false;$("#randCode2").removeClass("inptxt w100").addClass("inptxt w100 error");$("#c_error2").html(login_messages.randCodeLentgh).attr("class","error").css("margin-left","60px");$("#randCode2").focus()}}}$.ajax({url:ctx+"passcodeNew/checkRandCodeAnsyn",type:"post",data:{randCode:randCode,rand:"sjrand"},async:false,success:function(bN){if(bN.data.result!="1"){bM=false;$("#randCode2").removeClass("inptxt w100").addClass("inptxt w100 error");$("#c_error2").html("验证码不合法");$("#randCode2").val("");$("#c_error2").addClass("error");$("#i-ok2").css("display","none")}else{bM=true;$("#randCode2").removeClass("inptxt w100 error").addClass("inptxt w100");$("#i-ok2").css("display","block");$("#c_error2").html("");$("#c_error2").removeClass("error")}}});if(!bM){refreshImg("other","sjrand","img_rand_code2");$("#randCode2").focus();$("#c_error2").css("margin-left","15px")}return bM}});$(".dhx_modal_cover").css("background-color","#EEEEEE")}}}})}else{P=false;ak()}}else{P=true}}else{P=false;ak()}$("#trainum").html(bt.length);a8(bt)}}else{if(bt.length<0){P=true;$("#no_filter_ticket").show();$("#no_filter_ticket_msg_1").show();$("#no_filter_ticket_msg_2").hide();$("#trainum").html("0");return}else{P=true;$("#trainum").html(bt.length);a8(bt)}}}var E=0;var w;function ak(){var bB;if(rqChecked.length>1){if(E>=rqChecked.length){E=0}bB=rqChecked[E++]}else{bB=$.trim($("#train_date").val())}clearInterval(w);w=window.setInterval(function(){$("#train_date").val(bB);var bC={"leftTicketDTO.train_date":bB,"leftTicketDTO.from_station":$("#fromStation").val(),"leftTicketDTO.to_station":$("#toStation").val(),purpose_codes:"ADULT"};bw(bC)},autoSearchTime)}function aR(){if(aO.length==0){return}var bB=aS();var bC=h(bB);$("#train_stop").appendTo($("body")).hide();$("#queryLeftTable").html("");$("#trainum").html("");if(bC.length>0){$("#no_filter_ticket").hide();$("#trainum").html(bC.length)}else{$("#no_filter_ticket").show();$("#no_filter_ticket_msg_1").show();$("#no_filter_ticket_msg_2").hide();$("#trainum").html("0");return}a8(bC)}function at(bC){var bB=O.createWindow(bC+"_",0,0,660,100);bB.attachObject(bC);bB.clearIcon();bB.denyResize();bB.setModal(true);bB.center();bB.button("park").hide();bB.button("minmax1").hide();bB.hideHeader();return bB}function z(){var bG=new Array();$("#autosubmit_check_ticket_tit").html("");var bE=$("#train_date").val();var bB=C(new Date(Date.parse(bE.replace(/-/g,"/"))));var bC=aX.queryLeftNewDTO.station_train_code;var bL=null;var bM=aX.queryLeftNewDTO.from_station_name;var bF=aX.queryLeftNewDTO.to_station_name;var bH=aX.queryLeftNewDTO.start_time;var bK=aX.queryLeftNewDTO.arrive_time;var bJ=function(bO,bQ,bN,bS,bP,bR,bU,bT){this.date=bO;this.week=bQ;this.station_train_code=bN;this.train_headers=bS;this.from_station=bP;this.start_time=bR;this.to_station=bU;this.arrive_time=bT};var bD=new bJ(bE,bB,bC,bL,bM,bH,bF,bK);bG.push(bD);var bI=$("#autoSubTicketTitTemplate").html();$.templates({leftTableTemplate:bI});$("#autosubmit_check_ticket_tit").html($.render.leftTableTemplate(bG))}function aV(bN){if(w){clearInterval(w)}var bB="";var bC="";var bH="1";var bD="成人票";if($("#sf2").is(":checked")){bH="3";bD="学生票"}tickets_info=new Array();var bO=bN[1];var bG=bN[2];var bF=0;var bE=passengerChecked.length;for(var bI=0;bI<bG.length;bI++){var bK=bO.queryLeftNewDTO[bG[bI].toLowerCase()+"_num"];if(bK=="--"||bK=="无"){bK=0}else{if(bK=="有"){bK=20}else{bK=Number(bK)}}if(bF>=bE){break}var bL=bG[bI];bB=aI(bL);bC=bm(bL);for(var bJ=0;bJ<bK;bJ++){if(bF>=bE){break}tickets_info.push(new ay("sdAdd_"+aF(),bB,bC,bH,bD,passengerChecked[bF].passenger_name,passengerChecked[bF].passenger_id_type_code,passengerChecked[bF].passenger_id_type_name,passengerChecked[bF].passenger_id_no,passengerChecked[bF].mobile_no));bF++}}var bM=$("#autoSubCheckTicketInfoTemplate").html();$.templates({leftTableTemplate:bM});$("#autosubmit_check_ticketInfo").html($.render.leftTableTemplate(tickets_info))}function y(){var bD=aX.queryLeftNewDTO.yz_num;var bB=aX.queryLeftNewDTO.rz_num;var bH=aX.queryLeftNewDTO.yw_num;var bF=aX.queryLeftNewDTO.rw_num;var bG=aX.queryLeftNewDTO.gr_num;var bE=aX.queryLeftNewDTO.ze_num;var bJ=aX.queryLeftNewDTO.zy_num;var bK=aX.queryLeftNewDTO.tz_num;var bC=aX.queryLeftNewDTO.swz_num;var bI=aX.queryLeftNewDTO.wz_num;if(bD!="--"&&bD!="无"){bn="YZ";return}if(bE!="--"&&bE!="无"){bn="ZE";return}if(bH!="--"&&bH!="无"){bn="YW";return}if(bJ!="--"&&bJ!="无"){bn="ZY";return}if(bB!="--"&&bB!="无"){bn="RZ";return}if(bF!="--"&&bF!="无"){bn="RW";return}if(bK!="--"&&bK!="无"){bn="TZ";return}if(bG!="--"&&bG!="无"){bn="GR";return}if(bC!="--"&&bC!="无"){bn="SWZ";return}if(bI!="--"&&bI!="无"){bn="WZ";return}}function bm(bC){var bB="";if(bC=="ZY"){bB="一等座"}if(bC=="ZE"){bB="二等座"}if(bC=="SWZ"){bB="商务座"}if(bC=="TZ"){bB="特等座"}if(bC=="YZ"){bB="硬座"}if(bC=="RZ"){bB="软座"}if(bC=="YW"){bB="硬卧"}if(bC=="RW"){bB="软卧"}if(bC=="GR"){bB="高级软卧"}if(bC=="WZ"){bB="无座"}return bB}function aI(bC){var bB="";if(bC=="ZY"){bB="M"}if(bC=="ZE"){bB="O"}if(bC=="SWZ"){bB="9"}if(bC=="TZ"){bB="P"}if(bC=="YZ"){bB="1"}if(bC=="RZ"){bB="2"}if(bC=="YW"){bB="3"}if(bC=="RW"){bB="4"}if(bC=="GR"){bB="6"}if(bC=="WZ"){bB="WZ"}return bB}function ay(bI,bD,bE,bG,bF,bC,bK,bJ,bH,bB){this.only_id=bI,this.seat_type=bD;this.seat_type_name=bE;this.ticket_type=bG,this.ticket_type_name=bF;this.name=bC;this.id_type=bK;this.id_type_name=bJ;this.id_no=bH;this.phone_no=bB;this.toString=function(){return this.name+"_"+this.id_type+"_"+this.id_no+"_"+this.phone_no}}function aF(){if(tickets_info.length<1){return tickets_info.length}else{var bD=0;for(var bC=0;bC<tickets_info.length;bC++){var bB=Number(tickets_info[bC].only_id.split("_")[1]);if(bB>bD){bD=bB}}return bD+1}}function aZ(){bA=[];t=[];al=[];tickets_info.length=[];bh=[];bt=[];aX="";isAsync="";location_code="";md5Str="";leftTicketStr="";bn=""}getpassengerTicketsForAutoSubmit=function(){var bB="";for(var bC=0;bC<tickets_info.length;bC++){var bD=tickets_info[bC].seat_type+",0,"+tickets_info[bC].ticket_type+","+tickets_info[bC].name+","+tickets_info[bC].id_type+","+tickets_info[bC].id_no+","+(tickets_info[bC].phone_no==null?"":tickets_info[bC].phone_no)+",N";bB+=bD+"_"}return bB.substring(0,bB.length-1)};getOldPassengersForAutoSubmit=function(){var bD="";for(var bC=0;bC<passengerChecked.length;bC++){var bB=passengerChecked[bC].passenger_name+","+passengerChecked[bC].passenger_id_type_code+","+passengerChecked[bC].passenger_id_no+","+passengerChecked[bC].passenger_type;bD+=bB+"_"}return bD};function F(){$.ajax({url:ctx+"confirmPassenger/confirmSingle",type:"post",data:{passengerTicketStr:getpassengerTicketsForAutoSubmit(),oldPassengerStr:getOldPassengersForAutoSubmit(),tour_flag:"dc",randCode:$("#randCode").val(),purpose_codes:"ADULT",key_check_isChange:md5Str,train_location:location_code},dataType:"json",async:true,success:function(bB){if(bB.status){if(bB.data.submitStatus){otsRedirect("post",ctx+"payOrder/init?random="+new Date().getTime(),{})}else{b("出票失败!",false,"原因： "+bB.data.errMsg+'<a  id="xg_close_win_id">点击修改</a>',false,"lose");$("#xg_close_win_id").click(function(){bg("transforNotice_id",true);$("#i-ok").css("display","none")})}}else{b("订票失败!",true,"很抱歉！请关闭窗口重新预定车票",true,"lose")}},error:function(bB,bD,bC){b("订票失败!",true,"很抱歉！网络忙，请关闭窗口稍后再试。",true,"lose");return}})}function I(){$.ajax({url:ctx+"confirmPassenger/confirmSingleForQueue",type:"post",data:{passengerTicketStr:getpassengerTicketsForAutoSubmit(),oldPassengerStr:getOldPassengersForAutoSubmit(),randCode:$("#randCode").val(),purpose_codes:"ADULT",key_check_isChange:md5Str,leftTicketStr:leftTicketStr,train_location:location_code},dataType:"json",async:true,success:function(bB){if(bB.status){if(!bB.data.submitStatus){b("出票失败!",false,"原因： "+bB.data.errMsg+'<a id="xg_close_win_id" >点击修改</a>',false,"lose");$("#xg_close_win_id").click(function(){bg("transforNotice_id",true);$("#i-ok").css("display","none")})}else{var bC=new OrderQueueWaitTime("dc",aj,bb);bC.start()}}else{b("订票失败!",true,"很抱歉！请关闭窗口重新预定车票",true,"lose")}},error:function(bB,bD,bC){b("订票失败!",true,"很抱歉！网络忙，请关闭窗口稍后再试。",true,"lose");return}})}function aj(bB,bD,bC){if(bD<=5){b("订单已经提交，系统正在处理中，请稍等。",false,"",false,"work")}else{if(bD>30*60){b("订单已经提交，预计等待时间超过30分钟，请耐心等待。",false,"",false,"queue")}else{b("订单已经提交，最新预估等待时间"+bC+"，请耐心等待。",false,"",false,"queue")}}}function bb(bB,bD,bC){if(bD==-1){$.ajax({url:ctx+"confirmPassenger/resultOrderForDcQueue",data:{orderSequence_no:bC.orderId},type:"POST",dataType:"json",success:function(bE){if(bE.status){if(bE.data.submitStatus){otsRedirect("post",ctx+"/payOrder/init?random="+new Date().getTime(),{})}else{b("下单成功",false,"",false,"win")}}else{b("下单成功。",false,"",false,"win")}},error:function(bE,bG,bF){b("下单成功。",false,"",false,"win")}})}else{a3(bD,bC)}}function a3(bB,bC){if(bB==-1){return}else{if(bB==-2){if(bC.errorcode==0){b("订票失败!",true,"原因： "+bC.msg,false,"lose")}else{b("订票失败!",true,"原因： "+bC.msg,false,"lose")}}else{if(bB==-3){b("哎呀,订票失败!",true,"订单已撤销",false,"lose")}else{window.location.href=ctx+"queryOrder/initNoComplete?random="+new Date().getTime()}}}}function aG(){g=new dhtmlXWindows();g.enableAutoViewport(true);g.setSkin("dhx_terrace");g.setImagePath(ctx+"resources/js/rich/windows/imgs/");bg=function(bF,bE){unLoadGrayBackground();if(g.isWindow(bF+"_")){g.window(bF+"_").setModal(false);g.window(bF+"_").hide()}};b=function(bL,bI,bF,bE,bH){var bK='<div class="tit">'+(bI?'<span class="colorC">'+bL+"</span>":bL)+"</div>";var bG="<P>"+bF+"</p>";var bJ=bI?'<p>请点击[<a href="'+ctx+'queryOrder/init"><strong>我的12306</strong></a>]办理其他业务。您也可以点击[<a href="'+ctx+'leftTicket/init"><strong>预订车票</strong></a>]，重新规划您的旅程。</p>':'<P>查看订单处理情况，请点击“<a href="'+ctx+'queryOrder/initNoComplete">未完成订单</a>”</P>';$("#iamge_status_id").removeClass().addClass("icon i-"+bH);if(bE){$("#up-box-hd_id").html("提示<a id='closeTranforDialog_id' href='#nogo'>关闭</a>");bJ="";$("#lay-btn_id").html("<a href='#nogo' id='qr_closeTranforDialog_id'  class='btn122s '>确认</a>")}else{$("#up-box-hd_id").html("提示");$("#lay-btn_id").html("")}$("#orderResultInfo_id").html(bK+(bF==""||bF==null||bF=="undefined"||bF==undefined?"":bG)+bJ);bB("transforNotice_id");if(bE){$("#closeTranforDialog_id").click(function(){bg("transforNotice_id",true)});$("#qr_closeTranforDialog_id").click(function(){bg("transforNotice_id",true);$("#i-ok").css("display","none")})}};function bB(bI){bg(bI,false);if("checkticketinfo_id"==bI){var bG=ticketInfoForPassengerForm.queryLeftNewDetailDTO;if(bG.to_station_telecode==ticket_submit_order.special_areas.lso||bG.to_station_telecode==ticket_submit_order.special_areas.dao||bG.to_station_telecode==ticket_submit_order.special_areas.ado||bG.to_station_telecode==ticket_submit_order.special_areas.nqo||bG.to_station_telecode==ticket_submit_order.special_areas.tho){if(bC()){$("#notice_1_id").html("1.系统将随机为您申请席位，暂不支持自选席位。");$("#notice_2_id").html("2.根据现行规定，外国人在购买进西藏火车票时，须出示西藏自治区外事办公室或旅游局、商务厅的批准函（电），或者出示中国内地司局级接待单位出具的、已征得自治区上述部门同意的证明信函。台湾同胞赴藏从事旅游、商务活动，须事先向西藏自治区旅游局或商务厅提出申请，购买进藏火车票时须出示有关批准函。");if(bD()){$("#notice_3_id").html("3.按现行规定，学生票购票区间必须与学生证上的乘车区间一致，否则车站将不予换票。")}else{$("#notice_3_id").html("")}}}else{$("#notice_1_id").html("1.系统将随机为您申请席位，暂不支持自选席位。");if(bD()){$("#notice_3_id").html("2.按现行规定，学生票购票区间必须与学生证上的乘车区间一致，否则车站将不予换票。")}else{$("#notice_3_id").html("")}}}var bF=n(bI);var bE=$(window).width()/2-300;var bH=o()+($(window).height()/2-200);bF.setDimension($("#content_"+bI).width(),$("#content_"+bI).height()+10);$(".dhtmlx_window_active").height($("#content_"+bI).height());$(".dhtmlx_window_active").css({left:bE+"px",top:bH+"px"})}function bD(){for(var bF=0;bF<limit_tickets.length;bF++){var bE=limit_tickets[bF];if(bE.ticket_type==ticket_submit_order.ticket_type.student){return true}}return false}function bC(){for(var bF=0;bF<limit_tickets.length;bF++){var bE=limit_tickets[bF];if((ticketInfoForPassengerForm.tour_flag==ticket_submit_order.tour_flag.fc||ticketInfoForPassengerForm.tour_flag==ticket_submit_order.tour_flag.gc)&&bE.save_status!=""&&(bE.id_type==ticket_submit_order.passenger_card_type.passport||bE.id_type==ticket_submit_order.passenger_card_type.work||bE.id_type==ticket_submit_order.passenger_card_type.taiwan)){return true}else{if((ticketInfoForPassengerForm.tour_flag==ticket_submit_order.tour_flag.wc||ticketInfoForPassengerForm.tour_flag==ticket_submit_order.tour_flag.dc)&&(bE.id_type==ticket_submit_order.passenger_card_type.passport||bE.id_type==ticket_submit_order.passenger_card_type.work||bE.id_type==ticket_submit_order.passenger_card_type.taiwan)){return true}}}return false}}function n(bC){var bB=g.createWindow(bC+"_",0,0,660,100);bB.attachObject(bC);bB.clearIcon();bB.denyResize();bB.setModal(true);bB.center();bB.button("park").hide();bB.button("minmax1").hide();bB.hideHeader();return bB}function ar(bC){var bB=new Date();var bD=bC.split("-");bB.setFullYear(parseInt(bD[0]),parseInt(bD[1]-1,10),parseInt(bD[2],10));if(bD.length>=6){bB.setHours(bD[3],bD[4],bD[5])}return bB}function a7(bB){var bE="",bD="";var bG=bB.replace(/-/g,"");if(bG.substring(4,5)=="0"){bE=bG.substring(5,6)+"月"}else{bE=bG.substring(4,6)+"月"}if(bG.substring(6,7)=="0"){bD=bG.substring(7,8)+"日"}else{bD=bG.substring(6,8)+"日"}var bC=new Date(Date.parse(bB.replace(/-/g,"/")));var bF="日一二三四五六";return bE.concat(bD).concat("&nbsp;&nbsp;").concat("周").concat(bF.charAt(bC.getDay()))}showTicketPrice=function(bF){var bI=$(bF).parent("tr").children("td").children("div").children("div").children("span").attr("id");if(undefined==bI||bI==null||"undefined"==typeof(bI)){bI=$(bF).attr("id")}$("#price_"+bG).hide();$("#tp-list-price").hide();$("#sleeper-price>span").css("cursor","pointer");var bG=bI.split("_")[0];var bH=bI.split("_")[1];var bE=bI.split("_")[2];var bJ=bI.split("_")[3];var bD=bI.split("_")[4];var bB=$("#WZ_"+bG).html();var bC=$("#QT_"+bG).html();if($("#ticket_"+bG+"_train>span>span").text()=="查看票价"){if($("#ticket_"+bG).attr("class")=="bgc"){$("#price_"+bG).addClass("bgc")}$.ajax({type:"get",isTakeParam:false,beforeSend:function(bK){bK.setRequestHeader("If-Modified-Since","0");bK.setRequestHeader("Cache-Control","no-cache")},url:ctx+"leftTicket/queryTicketPrice",data:{train_no:bG,from_station_no:bH,to_station_no:bE,seat_types:bD,train_date:train_tour_flag=="fc"?$.trim($("#back_train_date").val()):$.trim($("#train_date").val())},success:function(bK){if(bK.status){$("#ticket_"+bG+"_train>span>span").html("收起票价");$("#ticket_"+bG+"_train>span>b").addClass("open");$("#ticket_"+bG+"_train>span>b").attr("title","收起票价");if(bC=="--"){bK.data.MIN=""}if(bB=="--"){bK.data.WZ=""}$("#price_"+bG).html($.render.priceTableTemplate(bK.data));$("#price_"+bG).show();if(bK.data.PM!="--"){$("#sleeper-price_"+bG).mouseover(function(){$("#tp-list-price_"+bG).show()});$("#sleeper-price_"+bG).mouseout(function(){$("#tp-list-price_"+bG).hide()})}}}})}else{$("#ticket_"+bG+"_train>span>span").html("查看票价");$("#ticket_"+bG+"_train>span>b").attr("title","查看票价");$("#ticket_"+bG+"_train>span>b").removeClass();$("#price_"+bG).html("");$("#price_"+bG).hide()}};function h(bB){if(ao=="starttime"){return bB.sort(function(bD,bC){var bF=Number(bD.queryLeftNewDTO.start_time.replace(":",""));var bE=Number(bC.queryLeftNewDTO.start_time.replace(":",""));if(bF>bE){return ae?1:-1}else{return ae?-1:1}})}else{if(ao=="arrivedtime"){return bB.sort(function(bD,bC){var bF=Number(bD.queryLeftNewDTO.arrive_time.replace(":",""));var bE=Number(bC.queryLeftNewDTO.arrive_time.replace(":",""));if(bF>bE){return be?1:-1}else{return be?-1:1}})}else{if(ao=="lishi"){return bB.sort(function(bD,bC){var bF=Number(bD.queryLeftNewDTO.lishi.replace(":",""));var bE=Number(bC.queryLeftNewDTO.lishi.replace(":",""));if(bF>bE){return aH?1:-1}else{return aH?-1:1}})}}}return bB}function aA(){$("#s_time").click(function(){if(ae){$("#s_time").removeClass().addClass("b4");if($("#r_time").attr("class")=="b4"){$("#r_time").removeClass().addClass("b2")}else{if($("#r_time").attr("class")=="b3"){$("#r_time").removeClass().addClass("b1")}}if($("#l_s").attr("class")=="b4"){$("#l_s").removeClass().addClass("b2")}else{if($("#l_s").attr("class")=="b3"){$("#l_s").removeClass().addClass("b1")}}ae=false;$("#other_span_starttime").removeClass().addClass("b4");if($("#other_span_endtime").attr("class")=="b4"){$("#other_span_endtime").removeClass().addClass("b2")}else{if($("#other_span_endtime").attr("class")=="b3"){$("#other_span_endtime").removeClass().addClass("b1")}}if($("#other_span_lishi").attr("class")=="b4"){$("#other_span_lishi").removeClass().addClass("b2")}else{if($("#other_span_lishi").attr("class")=="b3"){$("#other_span_lishi").removeClass().addClass("b1")}}}else{$("#s_time").removeClass().addClass("b3");if($("#r_time").attr("class")=="b4"){$("#r_time").removeClass().addClass("b2")}else{if($("#r_time").attr("class")=="b3"){$("#r_time").removeClass().addClass("b1")}}if($("#l_s").attr("class")=="b4"){$("#l_s").removeClass().addClass("b2")}else{if($("#l_s").attr("class")=="b3"){$("#l_s").removeClass().addClass("b1")}}ae=true;$("#other_span_starttime").removeClass().addClass("b3");if($("#other_span_endtime").attr("class")=="b4"){$("#other_span_endtime").removeClass().addClass("b2")}else{if($("#other_span_endtime").attr("class")=="b3"){$("#other_span_endtime").removeClass().addClass("b1")}}if($("#other_span_lishi").attr("class")=="b4"){$("#other_span_lishi").removeClass().addClass("b2")}else{if($("#other_span_lishi").attr("class")=="b3"){$("#other_span_lishi").removeClass().addClass("b1")}}}ao="starttime";aR()});$("#other_span_starttime").click(function(){if(ae){$("#s_time").removeClass().addClass("b4");if($("#r_time").attr("class")=="b4"){$("#r_time").removeClass().addClass("b2")}else{if($("#r_time").attr("class")=="b3"){$("#r_time").removeClass().addClass("b1")}}if($("#l_s").attr("class")=="b4"){$("#l_s").removeClass().addClass("b2")}else{if($("#l_s").attr("class")=="b3"){$("#l_s").removeClass().addClass("b1")}}ae=false;$("#other_span_starttime").removeClass().addClass("b4");if($("#other_span_endtime").attr("class")=="b4"){$("#other_span_endtime").removeClass().addClass("b2")}else{if($("#other_span_endtime").attr("class")=="b3"){$("#other_span_endtime").removeClass().addClass("b1")}}if($("#other_span_lishi").attr("class")=="b4"){$("#other_span_lishi").removeClass().addClass("b2")}else{if($("#other_span_lishi").attr("class")=="b3"){$("#other_span_lishi").removeClass().addClass("b1")}}}else{$("#s_time").removeClass().addClass("b3");if($("#r_time").attr("class")=="b4"){$("#r_time").removeClass().addClass("b2")}else{if($("#r_time").attr("class")=="b3"){$("#r_time").removeClass().addClass("b1")}}if($("#l_s").attr("class")=="b4"){$("#l_s").removeClass().addClass("b2")}else{if($("#l_s").attr("class")=="b3"){$("#l_s").removeClass().addClass("b1")}}ae=true;$("#other_span_starttime").removeClass().addClass("b3");if($("#other_span_endtime").attr("class")=="b4"){$("#other_span_endtime").removeClass().addClass("b2")}else{if($("#other_span_endtime").attr("class")=="b3"){$("#other_span_endtime").removeClass().addClass("b1")}}if($("#other_span_lishi").attr("class")=="b4"){$("#other_span_lishi").removeClass().addClass("b2")}else{if($("#other_span_lishi").attr("class")=="b3"){$("#other_span_lishi").removeClass().addClass("b1")}}}ao="starttime";aR()});$("#r_time").click(function(){if(be){$("#r_time").removeClass().addClass("b4");if($("#s_time").attr("class")=="b4"){$("#s_time").removeClass().addClass("b2")}else{if($("#s_time").attr("class")=="b3"){$("#s_time").removeClass().addClass("b1")}}if($("#l_s").attr("class")=="b4"){$("#l_s").removeClass().addClass("b2")}else{if($("#l_s").attr("class")=="b3"){$("#l_s").removeClass().addClass("b1")}}be=false;$("#other_span_starttime").removeClass().addClass("b4");$("#other_span_endtime").removeClass().addClass("b2");$("#other_span_lishi").removeClass().addClass("b2")}else{$("#r_time").removeClass().addClass("b3");if($("#s_time").attr("class")=="b4"){$("#s_time").removeClass().addClass("b2")}else{if($("#s_time").attr("class")=="b3"){$("#s_time").removeClass().addClass("b1")}}if($("#l_s").attr("class")=="b4"){$("#l_s").removeClass().addClass("b2")}else{if($("#l_s").attr("class")=="b3"){$("#l_s").removeClass().addClass("b1")}}be=true;$("#other_span_endtime").removeClass().addClass("b2");if($("#other_span_starttime").attr("class")=="b4"){$("#other_span_starttime").removeClass().addClass("b2")}else{if($("#other_span_starttime").attr("class")=="b3"){$("#other_span_starttime").removeClass().addClass("b1")}}if($("#other_span_lishi").attr("class")=="b4"){$("#other_span_lishi").removeClass().addClass("b2")}else{if($("#other_span_lishi").attr("class")=="b3"){$("#other_span_lishi").removeClass().addClass("b1")}}}ao="arrivedtime";aR()});$("#other_span_endtime").click(function(){if(be){$("#r_time").removeClass().addClass("b4");if($("#s_time").attr("class")=="b4"){$("#s_time").removeClass().addClass("b2")}else{if($("#s_time").attr("class")=="b3"){$("#s_time").removeClass().addClass("b1")}}if($("#l_s").attr("class")=="b4"){$("#l_s").removeClass().addClass("b2")}else{if($("#l_s").attr("class")=="b3"){$("#l_s").removeClass().addClass("b1")}}be=false;$("#other_span_endtime").removeClass().addClass("b4");if($("#other_span_starttime").attr("class")=="b4"){$("#other_span_starttime").removeClass().addClass("b2")}else{if($("#other_span_starttime").attr("class")=="b3"){$("#other_span_starttime").removeClass().addClass("b1")}}if($("#other_span_lishi").attr("class")=="b4"){$("#other_span_lishi").removeClass().addClass("b2")}else{if($("#other_span_lishi").attr("class")=="b3"){$("#other_span_lishi").removeClass().addClass("b1")}}}else{$("#r_time").removeClass().addClass("b3");if($("#s_time").attr("class")=="b4"){$("#s_time").removeClass().addClass("b2")}else{if($("#s_time").attr("class")=="b3"){$("#s_time").removeClass().addClass("b1")}}if($("#l_s").attr("class")=="b4"){$("#l_s").removeClass().addClass("b2")}else{if($("#l_s").attr("class")=="b3"){$("#l_s").removeClass().addClass("b1")}}be=true;$("#other_span_endtime").removeClass().addClass("b3");if($("#other_span_starttime").attr("class")=="b4"){$("#other_span_starttime").removeClass().addClass("b2")}else{if($("#other_span_starttime").attr("class")=="b3"){$("#other_span_starttime").removeClass().addClass("b1")}}if($("#other_span_lishi").attr("class")=="b4"){$("#other_span_lishi").removeClass().addClass("b2")}else{if($("#other_span_lishi").attr("class")=="b3"){$("#other_span_lishi").removeClass().addClass("b1")}}}ao="arrivedtime";aR()});$("#l_s").click(function(){if(aH){$("#l_s").removeClass().addClass("b4");if($("#r_time").attr("class")=="b4"){$("#r_time").removeClass().addClass("b2")}else{if($("#r_time").attr("class")=="b3"){$("#r_time").removeClass().addClass("b1")}}if($("#s_time").attr("class")=="b4"){$("#s_time").removeClass().addClass("b2")}else{if($("#s_time").attr("class")=="b3"){$("#s_time").removeClass().addClass("b1")}}aH=false;$("#other_span_lishi").removeClass().addClass("b4");if($("#other_span_endtime").attr("class")=="b4"){$("#other_span_endtime").removeClass().addClass("b2")}else{if($("#other_span_endtime").attr("class")=="b3"){$("#other_span_endtime").removeClass().addClass("b1")}}if($("#other_span_starttime").attr("class")=="b4"){$("#other_span_starttime").removeClass().addClass("b2")}else{if($("#other_span_starttime").attr("class")=="b3"){$("#other_span_starttime").removeClass().addClass("b1")}}}else{$("#l_s").removeClass().addClass("b3");if($("#r_time").attr("class")=="b4"){$("#r_time").removeClass().addClass("b2")}else{if($("#r_time").attr("class")=="b3"){$("#r_time").removeClass().addClass("b1")}}if($("#s_time").attr("class")=="b4"){$("#s_time").removeClass().addClass("b2")}else{if($("#s_time").attr("class")=="b3"){$("#s_time").removeClass().addClass("b1")}}aH=true;$("#other_span_lishi").removeClass().addClass("b3");if($("#other_span_endtime").attr("class")=="b4"){$("#other_span_endtime").removeClass().addClass("b2")}else{if($("#other_span_endtime").attr("class")=="b3"){$("#other_span_endtime").removeClass().addClass("b1")}}if($("#other_span_starttime").attr("class")=="b4"){$("#other_span_starttime").removeClass().addClass("b2")}else{if($("#other_span_starttime").attr("class")=="b3"){$("#other_span_starttime").removeClass().addClass("b1")}}}ao="lishi";aR()});$("#other_span_lishi").click(function(){if(aH){$("#l_s").removeClass().addClass("b4");if($("#r_time").attr("class")=="b4"){$("#r_time").removeClass().addClass("b2")}else{if($("#r_time").attr("class")=="b3"){$("#r_time").removeClass().addClass("b1")}}if($("#s_time").attr("class")=="b4"){$("#s_time").removeClass().addClass("b2")}else{if($("#s_time").attr("class")=="b3"){$("#s_time").removeClass().addClass("b1")}}aH=false;$("#other_span_lishi").removeClass().addClass("b4");if($("#other_span_endtime").attr("class")=="b4"){$("#other_span_endtime").removeClass().addClass("b2")}else{if($("#other_span_endtime").attr("class")=="b3"){$("#other_span_endtime").removeClass().addClass("b1")}}if($("#other_span_starttime").attr("class")=="b4"){$("#other_span_starttime").removeClass().addClass("b2")}else{if($("#other_span_starttime").attr("class")=="b3"){$("#other_span_starttime").removeClass().addClass("b1")}}}else{$("#l_s").removeClass().addClass("b3");if($("#r_time").attr("class")=="b4"){$("#r_time").removeClass().addClass("b2")}else{if($("#r_time").attr("class")=="b3"){$("#r_time").removeClass().addClass("b1")}}if($("#s_time").attr("class")=="b4"){$("#s_time").removeClass().addClass("b2")}else{if($("#s_time").attr("class")=="b3"){$("#s_time").removeClass().addClass("b1")}}aH=true;$("#other_span_lishi").removeClass().addClass("b3");if($("#other_span_endtime").attr("class")=="b4"){$("#other_span_endtime").removeClass().addClass("b2")}else{if($("#other_span_endtime").attr("class")=="b3"){$("#other_span_endtime").removeClass().addClass("b1")}}if($("#other_span_starttime").attr("class")=="b4"){$("#other_span_starttime").removeClass().addClass("b2")}else{if($("#other_span_starttime").attr("class")=="b3"){$("#other_span_starttime").removeClass().addClass("b1")}}}ao="lishi";aR()})}closeTrainStop=function(){over_flag=false;bk=0;$("#train_stop").hide();$("#train_table").html("")};hideTrainStop=function(bB){over_flag=false;if(ah){clearTimeout(ah)}ah=window.setTimeout(function(){if(bk!=1){bk=0;$("#train_stop").hide();$("#train_table").html("")}},130)};checkHover=function(bC,bB){if(getEvent(bC).type=="mouseover"){return !$.contains(bB,getEvent(bC).relatedTarget||getEvent(bC).fromElement)&&!((getEvent(bC).relatedTarget||getEvent(bC).fromElement)===bB)}else{return !$.contains(bB,getEvent(bC).relatedTarget||getEvent(bC).toElement)&&!((getEvent(bC).relatedTarget||getEvent(bC).toElement)===bB)}};getEvent=function(bB){return bB||window.event};checkHover=function(bC,bB){if(getEvent(bC).type=="mouseover"){return !$.contains(bB,getEvent(bC).relatedTarget||getEvent(bC).fromElement)&&!((getEvent(bC).relatedTarget||getEvent(bC).fromElement)===bB)}else{return !$.contains(bB,getEvent(bC).relatedTarget||getEvent(bC).toElement)&&!((getEvent(bC).relatedTarget||getEvent(bC).toElement)===bB)}};getEvent=function(bB){return bB||window.event};function ba(bD,bB){for(var bC=0;bC<bB.length;bC++){if(bB[bC].key==bD){return true}}return false}function bc(bF){var bK=function(bL){this.value=bL};var bG=new Array();var bC=new Array();var bE={};var bB={};$("#cc_from_station_name_all>ul").html("");$("#cc_to_station_name_all>ul").html("");var bD;var bJ;var bI;for(var bH=0;bH<bF.length;bH++){bD=bF[bH].queryLeftNewDTO.from_station_name;bJ=bF[bH].queryLeftNewDTO.to_station_name;bI=bF[bH];if(!bE[bD]){bG.push(new bK(bD));bE[bD]=true}if(!bB[bJ]){bC.push(new bK(bJ));bB[bJ]=true}}$("#to_station_ul").html($.render.toStationNameTableTemplate(bC));$("#from_station_ul").html($.render.stationNameTableTemplate(bG));$("#sear-sel-bd input[name='cc_from_station']").click(function(){bx(bi,"cc_from_station_"+$(this).val());var bL=$("input[name='cc_from_station']");var bM=$("input[name='cc_from_station']:checked");if($(this).is(":checked")){if(bL&&bM&&bM.length==bL.length){$("#from_station_name_all").removeClass().addClass("btn-all")}else{$("#from_station_name_all").removeClass().addClass("btn-all btn-all-sel")}}else{if(bL&&bM&&bM.length==0){$("#from_station_name_all").removeClass().addClass("btn-all")}else{$("#from_station_name_all").removeClass().addClass("btn-all btn-all-sel")}}aR()});$("#sear-sel-bd input[name='cc_to_station']").click(function(){bx(a9,"cc_to_station_"+$(this).val());var bL=$("input[name='cc_to_station']");var bM=$("input[name='cc_to_station']:checked");if($(this).is(":checked")){if(bL&&bM&&bM.length==bL.length){$("#to_station_name_all").removeClass().addClass("btn-all")}else{$("#to_station_name_all").removeClass().addClass("btn-all btn-all-sel")}}else{if(bL&&bM&&bM.length==0){$("#to_station_name_all").removeClass().addClass("btn-all")}else{$("#to_station_name_all").removeClass().addClass("btn-all btn-all-sel")}}aR()})}submitOrderRequest=function(bC,bB){$.ajax({type:"post",url:ctx+"login/checkUser",data:{},success:function(bD){var bF;checkusermdId=bD.attributes;if(bD.data.flag){if(train_tour_flag=="fc"){bF=$("#back_train_date").val()}else{bF=$("#train_date").val()}if(k=="0X00"){var bE=false;for(i=(studentComPerArr.length-1);i>=0;i=i-2){if(ar(studentComPerArr[i-1])<=ar(bF)&&ar(studentComPerArr[i])>=ar(bF)){bE=true;break}}if(!bE){aT("学生票的乘车时间为每年的暑假6月1日至9月30日、寒假12月1日至3月31日，目前不办理学生票业务。");return}}H(bC,bB)}else{at();$("#floatTable").hide();s=$(window).scrollTop();aq(bC,bB)}}})};function H(bO,bH){var bB="";if($("#dc").is(":checked")){bB="dc"}else{bB="wc"}if(train_tour_flag=="fc"){bB="fc";var bF=bH.split(":");var bD=$("#back_train_date").val()+"-"+bF[0]+"-"+bF[1]+"-00";try{if(roundReferTime){if(ar(roundReferTime)>=ar(bD)){aT("您预订的往程车票到站时间为"+ar(roundReferTime).format("yyyy年MM月dd日 hh时mm分")+"，返回日期不能早于此时间");return}}}catch(bJ){}}if(train_tour_flag=="gc"){bB="gc"}var bC=submitForm();var bN=bC.split(":::");var bI=bN[0].split(",-,")[0];var bL=bN[0].split(",-,")[1];var bG=bN[1].split(",-,")[0];var bK=bN[1].split(",-,")[1];var bM=checkusermdId!=undefined?"&_json_att="+encodeURIComponent(checkusermdId):"";var bE=escape(bI)+"="+escape(bL)+"&"+bG+"="+bK+"&secretStr="+bO+"&train_date="+$("#train_date").val()+"&back_train_date="+$("#back_train_date").val()+"&tour_flag="+bB+"&purpose_codes="+k+"&query_from_station_name="+$("#fromStationText").val()+"&query_to_station_name="+$("#toStationText").val()+bM;$.ajax({type:"post",url:ctx+"leftTicket/submitOrderRequest",data:bE,success:function(bP){if(bP.status){if(train_tour_flag!=null){if(train_tour_flag=="fc"){otsRedirect("post",ctx+"confirmPassenger/initFc",{});return}if(train_tour_flag=="gc"){otsRedirect("post",ctx+"confirmPassenger/initGc",{});return}}if(bB=="dc"){otsRedirect("post",ctx+"confirmPassenger/initDc",{});return}else{otsRedirect("post",ctx+"confirmPassenger/initWc",{})}}}})}var U=$("#fromStation").val();var ax=$("#toStation").val();var M=$.trim($("#train_date").val());N=U+ax+M;$("#add-train").click(function(){var bC=$("#prior_train span").length;var bE=$.trim($("#inp-train").val()).toUpperCase();if(bE.length==0||bE=="请输入"){dhtmlx.alert({title:"输入车次",ok:"确定",text:"请输入车次",type:"alert-error",callback:function(){$("#inp-train").val("");$("#inp-train").focus()}})}else{if(bC<6){var bI=/^[a-zA-Z0-9]+$/;var bD=/^[0-9]+$/;if(!bI.test(bE)){dhtmlx.alert({title:"输入车次",ok:"确定",text:"车次格式输入错误！",type:"alert-error",callback:function(){ccInputSelected=true;$("#inp-train").select()}})}else{if(bD.test(bE)&&bE.length>4){dhtmlx.alert({title:"输入车次",ok:"确定",text:"车次格式输入错误！",type:"alert-error",callback:function(){ccInputSelected=true;$("#inp-train").select()}})}else{if(bE.length<2){dhtmlx.alert({title:"输入车次",ok:"确定",text:"车次格式输入错误！",type:"alert-error",callback:function(){ccInputSelected=true;$("#inp-train").select()}})}else{var bK=$("#fromStation").val();var bL=$("#toStation").val();var bF=$.trim($("#train_date").val());var bN=bK+bL+bF;var bJ={"leftTicketDTO.train_date":bF,"leftTicketDTO.from_station":bK,"leftTicketDTO.to_station":bL,purpose_codes:"ADULT"};if(bN!=N){N=bN;$("#prior_train span:gt(0)").remove();ccSelected=[];var bM=[];$.ajax({type:"get",async:false,isTakeParam:false,cache:false,beforeSend:function(bO){bO.setRequestHeader("If-Modified-Since","0");bO.setRequestHeader("Cache-Control","no-cache")},url:ctx+"leftTicket/query",data:bJ,timeout:10000,success:function(bO){if(bO.status){if(bO.data==null||bO.data.length==0){dhtmlx.alert({title:"错误信息",ok:"确定",text:"您输入的车次在发到站间不存在，请重新输入！",type:"alert-error",callback:function(){}})}else{var bQ=bO.data;for(var bP=0;bP<bQ.length;bP++){bM.push(bQ[bP].queryLeftNewDTO.station_train_code.toUpperCase())}bf=bM}}}})}else{if(bf.length==0){$.ajax({type:"get",async:false,isTakeParam:false,cache:false,beforeSend:function(bO){bO.setRequestHeader("If-Modified-Since","0");bO.setRequestHeader("Cache-Control","no-cache")},url:ctx+"leftTicket/query",data:bJ,timeout:10000,success:function(bO){if(bO.status){if(bO.data==null||bO.data.length==0){dhtmlx.alert({title:"错误信息",ok:"确定",text:"您输入的车次在发到站间不存在，请重新输入！",type:"alert-error",callback:function(){}})}else{var bQ=bO.data;for(var bP=0;bP<bQ.length;bP++){bf.push(bQ[bP].queryLeftNewDTO.station_train_code.toUpperCase())}}}}})}}var bB=false;for(var bH=0;bH<bf.length;bH++){if(bE==bf[bH]){bB=true;break}}if(!bB){dhtmlx.alert({title:"错误信息",ok:"确定",text:"您输入的车次在发到站间不存在，请重新输入！",type:"alert-error",callback:function(){}})}else{if($.inArray(bE,ccSelected)<0){var bG="<span class='sel-box w80'>"+bE+"<a class='close' href='javascript:' onclick='$.removeSel(this,\""+bE+"\",4)'></a></span>";$("#prior_train").append(bG);ccSelected.push(bE);$("#inp-train").val("")}else{dhtmlx.alert({title:"输入车次",ok:"确定",text:"此车次已经添加过！",type:"alert-error",callback:function(){ccInputSelected=true;$("#inp-train").select()}})}}}}}}else{dhtmlx.alert({title:"输入车次",ok:"确定",text:"最多添加5个优先车次",type:"alert-error"});$("#inp-train").val("")}}});jQuery.extend({init_ul4li:function(){var bB=[];var bC=0;bB[bC++]='<li><input name="cc_type" value="G" type="checkbox" class="check" /><label for="">GC-高铁/城际</label></li>';bB[bC++]='<li><input name="cc_type" value="D" type="checkbox" class="check" /><label for="">D-动车</label></li>';bB[bC++]='<li><input name="cc_type" value="Z" type="checkbox" class="check" /><label for="">Z-直达</label></li>';bB[bC++]='<li><input name="cc_type" value="T" type="checkbox" class="check" /><label for="">T-特快</label></li>';bB[bC++]='<li><input name="cc_type" value="K" type="checkbox" class="check" /><label for="">K-快速</label></li>';bB[bC++]='<li><input name="cc_type" value="QT" type="checkbox" class="check" /><label for="">其他</label></li>';$("#startendtime").html('<span class="b3" id="s_time">出发时间</span><br /><span class="b2" id="r_time">到达时间</span>');$("#floatstartendtime").html('<span class="b3" id="other_span_starttime">出发时间</span><br /><span class="b2" id="other_span_endtime">到达时间</span>')},renderPassenger:function(){if(passengerAll){var bF=passengerAll.length;var bE=[];var bB=$("#searchPassenger").val();for(var bD=0;bD<bF;bD++){var bI=passengerAll[bD];var bH=bI.passenger_type_name;if(!bH){bH=""}var bG="";var bC="";if($("#sf2").is(":checked")){if(bI.passenger_type!="3"){bG=" disabled='true' ";bC=" class='color999' "}}if(bB!=""&&bB!="输入乘客姓名"){if(bI.passenger_name.indexOf(bB)>-1){bE[bD]="<li "+bC+"><input type='checkbox' "+bG+" name='"+bI.passenger_type+"' class='check' />"+bI.passenger_name+"("+bH+")("+bI.passenger_id_no+")</li>"}}else{bE[bD]="<li "+bC+"><input type='checkbox' "+bG+" name='"+bI.passenger_type+"' class='check' />"+bI.passenger_name+"("+bH+")("+bI.passenger_id_no+")</li>"}}$("#buyer-list").html(bE.join(""))}$("#buyer-list input").click(function(){var bK=$("#setion_postion span").length;var bL=this.nextSibling.nodeValue;if(this.checked){if(bK<6){var bJ="<span name='"+bL+"' class='sel-box w80'>"+bL+"<a class='close' href='javascript:' onclick='$.removeSel(this,\""+bL+"\",1)'></a></span>";$("#setion_postion").append(bJ);$.checkedPasseanger(bL)}else{dhtmlx.alert({title:"添加常用联系人",ok:"确定",text:"最多添加5位联系人",type:"alert-error"});this.checked=false}}else{$.each($("#setion_postion span"),function(bM,bN){if(bL==$(bN).attr("name")){$(bN).remove();$.removePasseanger(bL);return}})}});passengerChecked=[]},reloadPassenger:function(){var bD=dhtmlx.modalbox({targSrc:'<div><img src="'+ctx+'resources/images/loading.gif"></img></div>',callback:function(){}});$.ajax({type:"post",isTakeParam:false,url:ctx+"confirmPassenger/getPassengerDTOs",timeout:10000,error:function(bE,bG,bF){dhtmlx.modalbox.hide(bD)},success:function(bE){dhtmlx.modalbox.hide(bD);if(bE.status){if(bE.data.noLogin=="true"){at();$("#floatTable").hide();s=$(window).scrollTop();aU()}else{passengerAll=bE.data.normal_passengers;$("#sel-buyer").show();$("#sel-seat").hide();$("#sel-date").hide();$("#sel-buyer").css("left",$("#sear-sel").position().left+80);$("#sel-buyer").css("top",$("#sear-sel").position().top+4*28+16);$.renderPassenger()}}}});var bC=$("#setion_postion span");if(bC.length>1){for(var bB=1;bB<bC.length;bB++){bC[bB].remove()}}},showSelectBuyer:function(){if(!passengerAll){$.reloadPassenger()}else{var bB=$("#buyer-list input");for(var bC=0;bC<bB.length;bC++){var bD=$(bB[bC]).attr("name");if($("#sf2").is(":checked")){if(bD!="3"){$(bB[bC]).attr("disabled","true");$(bB[bC]).parent().addClass("color999")}else{$(bB[bC]).removeAttr("disabled");$(bB[bC]).parent().removeClass("color999")}}else{$(bB[bC]).removeAttr("disabled");$(bB[bC]).parent().removeClass("color999")}}$("#sel-buyer").show();$("#sel-seat").hide();$("#sel-date").hide();$("#sel-buyer").css("left",$("#sear-sel").position().left+80);$("#sel-buyer").css("top",$("#sear-sel").position().top+4*28+16)}}});function aa(){$("#show_all_query_result").click(function(){bi=new Array();a9=new Array();aM=new Array();$("#train_type_btn_all").removeClass().addClass("btn-all");$("#start_time_btn_all").removeClass().addClass("btn-all");$("#arrive_time_btn_all").removeClass().addClass("btn-all");$("#seat_type_btn_all").removeClass().addClass("btn-all");$("#from_station_name_all").removeClass().addClass("btn-all");$("#to_station_name_all").removeClass().addClass("btn-all");$("#sear-sel-bd input").each(function(){if(this.checked){this.checked=false}});if(Q){Q.setComboText("")}aR()})}function aP(){var bB=$("#queryPriceTemplate").html().replace("<!--","").replace("-->","");$.templates({priceTableTemplate:bB});var bB=$("#fromStationNameTemplate").html().replace("<!--","").replace("-->","");$.templates({stationNameTableTemplate:bB});var bB=$("#toStationNameTemplate").html().replace("<!--","").replace("-->","");$.templates({toStationNameTableTemplate:bB});var bB=$("#seatTypeTemplate").html().replace("<!--","").replace("-->","");$.templates({seatTypeTemplate:bB});var bB=$("#stationinfoTemplate").html().replace("<!--","").replace("-->","");$.templates({stationinfoTemplate:bB})}function j(bC){dhtmlXCombo_defaultOption.prototype._DrawHeaderButton=function(){};$("#train_combo_box").hide();var bB=[];if(!Q){Q=new dhtmlXCombo("train_combo_box_div","cc",90)}else{Q.setComboText("")}Q.clearAll();Q.addOption(bB);Q.enableFilteringMode(true);Q.attachEvent("onChange",function(){if(Q.getComboText()!=""){if($("#iLcear").is(":hidden")){$("#iLcear").show()}}aR()});if(!$("#iLcear")[0]){$(".dhx_combo_box ").append($('<span style="display: none;" class="i-clear dhx_combo_img_iClear" id="iLcear"></span>'));$("#iLcear").on("click",function(){if(Q){Q.setComboText("");$(this).hide()}})}$(".dhx_combo_input").on("keyup",function(){if($(this).val()==""){$("#iLcear").hide()}else{if($("#iLcear").is(":hidden")){$("#iLcear").show()}}})}function Z(){if(!O){O=new dhtmlXWindows();O.enableAutoViewport(true);O.setSkin("dhx_terrace");O.attachViewportTo("winVP");O.setImagePath(ctx+"resources/js/rich/windows/imgs/")}}function A(){O.window("login").hide();O.window("login").setModal(false)}function at(){if(O.window("login")){O.window("login").setModal(false);O.window("login").hide()}av=O.createWindow("login",0,0,400,350);var bB=$(window).width()/2-140;var bC=o()+($(window).height()/2-205);av.attachObject("relogin");av.setDimension($("#content").width(),$("#content").height()+10);$(".dhtmlx_window_active").height($("#content").height());$(".dhtmlx_window_active").css({left:bB,top:bC});av.bringToTop();O.window("login").clearIcon();O.window("login").denyResize();av.button("park").hide();av.button("minmax1").hide();av.hideHeader();av.setModal(true);$("#relogin_close").click(function(){aC();$("#floatTable").show();A()})}function aC(){D();$("#c_error").html("");$("#c_error").removeClass("error");$("#username").val("");$("#password").val("");$("#randCode").val("");$("#i-ok").hide();refreshImg("other","sjrand");au()}function o(){if("pageYOffset" in window){return window.pageYOffset}else{if(document.compatMode=="BackCompat"){return document.body.scrollTop}else{return document.documentElement.scrollTop}}}function D(){$("#username").removeClass("inptxt w200 error").addClass("inptxt w200");$("#password").removeClass("inptxt w200 error").addClass("inptxt w200");$("#randCode").removeClass("inptxt w100 error").addClass("inptxt w100");$("#randCode2").removeClass("inptxt w100 error").addClass("inptxt w100")}function R(bE){var bB=true;var bC=/^[A-Za-z]{1}([A-Za-z0-9]|[_]){0,29}$/;var bD=/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i;if(""==bE||bE==null||bE=="用户名／邮箱"||bE=="admin"){bB=false;D();$("#username").removeClass("inptxt w200").addClass("inptxt w200 error");$("#c_error").html(login_messages.userNameEmpty).attr("class","error").css("margin-left","60px");$("#username").focus()}else{if(!bC.test(bE)&&!bD.test(bE)){bB=false;D();$("#username").removeClass("inptxt w200").addClass("inptxt w200 error");$("#c_error").html(login_messages.userNameFormat).attr("class","error").css("margin-left","60px");$("#username").focus()}}if(bB){D();$("#c_error").html("");$("#c_error").removeClass("error")}return bB}function l(bC){var bB=true;if(""==bC||bC==null){bB=false;D();$("#password").removeClass("inptxt w200").addClass("inptxt w200 error");$("#c_error").html(login_messages.passwordEmpty).attr("class","error").css("margin-left","60px");$("#password").focus()}else{if(bC.length<6){bB=false;D();$("#password").removeClass("inptxt w200").addClass("inptxt w200 error");$("#c_error").html(login_messages.passwordLength).attr("class","error").css("margin-left","60px");$("#password").focus()}}if(bB){D();$("#c_error").html("");$("#c_error").removeClass("error")}return bB}function ai(bC){var bB=true;if(""==bC){bB=false;D();$("#randCode").removeClass("inptxt w100").addClass("inptxt w100 error");$("#c_error").html(login_messages.randCodeEmpty).attr("class","error").css("margin-left","60px");$("#randCode").focus()}else{if(!/^[a-zA-Z0-9]+$/.test(bC)){bB=false;D();$("#randCode").removeClass("inptxt w100").addClass("inptxt w100 error");$("#c_error").html(login_messages.randCodeFormat).attr("class","error").css("margin-left","60px");$("#randCode").focus()}else{if(bC.length!=4){bB=false;D();$("#randCode").removeClass("inptxt w100").addClass("inptxt w100 error");$("#c_error").html(login_messages.randCodeLentgh).attr("class","error").css("margin-left","60px");$("#randCode").focus()}else{if(!bp(bC)){bB=false;D();$("#randCode").removeClass("inptxt w100").addClass("inptxt w100 error");$("#c_error").html(login_messages.randCodeError).attr("class","error").css("margin-left","60px");$("#randCode").focus()}}}}if(bB){D();$("#c_error").html("");$("#c_error").removeClass("error")}return bB}function B(){var bD=$.trim($("#username").val());var bC=$.trim($("#password").val());var bB=$.trim($("#randCode").val());if(!R(bD)){return false}if(!l(bC)){return false}if(!ai(bB)){return false}return true}function bp(bC){var bB=true;if(bC!=""&&bC.length==4){$.ajax({url:ctx+"passcodeNew/checkRandCodeAnsyn",type:"post",data:{randCode:bC,rand:"sjrand"},async:false,success:function(bD){if(bD.data=="N"){bB=false;$("#i-ok").css("display","none")}else{bB=true;$("#i-ok").css("display","block");$("#c_error").html("");$("#c_error").removeClass("error");D()}}})}else{bB=false;$("#i-ok").css("display","none")}return bB}function aK(){var bC=false;var bB=false;$("#username").on("keyup",function(){ad=true;var bD=$.trim($("#username").val());bC=R(bD)}).blur(function(){if(ad){var bD=$.trim($("#username").val());bC=R(bD)}});$("#password").blur(function(){if(ad){if(bC){var bD=$.trim($("#password").val());bB=l(bD)}}});$("#randCode").on("keyup",function(){if($.trim($("#password").val())!=""&&$.trim($("#password").val())!=null){if(bB){var bD=$.trim($("#randCode").val());bp(bD)}}}).blur(function(){if($.trim($("#password").val())!=""&&$.trim($("#password").val())!=null){if(bB){var bD=$.trim($("#randCode").val());ai(bD)}}})}function aq(bC,bB){$("#loginSubAsyn").unbind("click");$("#loginSubAsyn").click(function(){var bD=B();if(bD){$("#loginForm").ajaxSubmit({url:ctx+"login/loginUserAsyn?random="+new Date().getTime(),type:"post",dataType:"json",async:false,success:function(bE){if(bE.data.status){if(bE.data.username!=null){A();loginAsyn(bE.data.username);H(bC,bB)}}else{$("#i-ok").hide();refreshImg("other","sjrand");$("#password").val("");$("#randCode").val("");if(bE.data.loginFail!=null){if(bE.data.loginFail=="登录名不存在!"){ad=false;D();$("#username").removeClass("inptxt w200").addClass("inptxt w200 error");$("#c_error").html(bE.data.loginFail).attr("class","error").css("margin-left","60px")}else{if(bE.data.loginFail=="验证码不正确！"&&bE.data.loginFail!="登录名不存在!"){D();$("#randCode").removeClass("inptxt w100").addClass("inptxt w200 error");$("#c_error").html(bE.data.loginFail).attr("class","error").css("margin-left","60px");$("#randCode").focus()}else{if(bE.data.loginFail!="验证码不正确！"&&bE.data.loginFail!="登录名不存在!"){D();$("#password").removeClass("inptxt w200").addClass("inptxt w200 error");$("#c_error").html(bE.data.loginFail).attr("class","error").css("margin-left","60px");$("#password").focus()}}}}}}})}else{at()}})}function aU(){$("#loginSubAsyn").unbind("click");$("#loginSubAsyn").click(function(){var bB=B();if(bB){$("#loginForm").ajaxSubmit({url:ctx+"login/loginUserAsyn?random="+new Date().getTime(),type:"post",dataType:"json",async:false,success:function(bC){if(bC.data.status){if(bC.data.username!=null){A();loginAsyn(bC.data.username)}}else{$("#i-ok").hide();refreshImg("other","sjrand");$("#password").val("");$("#randCode").val("");if(bC.data.loginFail!=null){if(bC.data.loginFail=="登录名不存在!"){ad=false;D();$("#username").removeClass("inptxt w200").addClass("inptxt w200 error");$("#c_error").html(bC.data.loginFail).attr("class","error").css("margin-left","60px")}else{if(bC.data.loginFail=="验证码不正确！"&&bC.data.loginFail!="登录名不存在!"){D();$("#randCode").removeClass("inptxt w100").addClass("inptxt w200 error");$("#c_error").html(bC.data.loginFail).attr("class","error").css("margin-left","60px");$("#randCode").focus()}else{if(bC.data.loginFail!="验证码不正确！"&&bC.data.loginFail!="登录名不存在!"){D();$("#password").removeClass("inptxt w200").addClass("inptxt w200 error");$("#c_error").html(bC.data.loginFail).attr("class","error").css("margin-left","60px");$("#password").focus()}}}}}}})}else{at()}})}function a1(){$("#randCode").keydown(function(bB){bB=bB||window.event;if(bB.keyCode==13||bB.keyCode==9){$("#loginSubAsyn").click()}})}function au(){$("#username").css("color","#333");$("#password").css("color","#333");$("#randCode").css("color","#333");if($("#username").val()==""||$("#username").val()=="用户名／邮箱"||$("#username").val()==null||$("#username").val()=="admin"){$("#username").css("color","#999");$("#username").val("用户名／邮箱");$("#password").val("")}$("#username").focus(function(){var bB=$("#username").val();if(bB=="用户名／邮箱"){$("#username").css("color","#333");$("#username").val("");$("#password").val("")}}).blur(function(){var bB=$("#username").val();if(bB==""){$("#username").css("color","#999");$("#username").val("用户名／邮箱")}})}function aE(){var bB=1;var bH;var bL;var bD;var bG=true;var bF=true;var bJ=true;var bM;var bC;var bK=false;bD=dataNumber;var bI;if(train_tour_flag!=null&&train_tour_flag!=""&&train_tour_flag=="fc"){bI=jQuery.inArray($("#back_train_date").val().substring(5,10),change_dates_arr)}else{bI=jQuery.inArray($("#train_date").val().substring(5,10),change_dates_arr)}if(bI!="-1"){bI=bI+1;if(bI>=firstShow&&bI<=endShow){bG=false;bF=false;bJ=false;bL=endShow+1}else{bM=firstShow;bC=endShow;bK=true;firstShow=bI;endShow=firstShow+19;if(endShow>dataNumber){endShow=dataNumber;firstShow=endShow-19;bH=firstShow-1;bF=false}else{bH=firstShow-1;bL=endShow+1;if(bH<bB){bG=false}}}if(bG){for(var bE=bB;bE<=bH;bE++){$("#date_range>ul>li:nth-child("+bE+")").hide()}}if(bF){for(var bE=bL;bE<=bD;bE++){$("#date_range>ul>li:nth-child("+bE+")").hide()}}if(bJ){for(var bE=firstShow;bE<=endShow;bE++){$("#date_range>ul>li:nth-child("+bE+")").show()}}$("#date_range>ul>li").removeClass("sel");if(bK){$("#date_range>ul>li:nth-child("+bM+")").children("span:first").removeClass();$("#date_range>ul>li:nth-child("+bM+")").children("span:last").removeClass();$("#date_range>ul>li:nth-child("+bC+")").removeClass();$("#date_range>ul>li:nth-child("+firstShow+")").children("span:first").addClass("first");$("#date_range>ul>li:nth-child("+firstShow+")").children("span:last").addClass("first");$("#date_range>ul>li:nth-child("+firstShow+")").children().addClass("first");$("#date_range>ul>li:nth-child("+endShow+")").addClass("end")}$("#date_range>ul>li:nth-child("+bI+")").addClass("sel");$("#date_range>ul>li:nth-child("+bI+")").children("span:last-child").removeClass();$("#date_range>ul>li:nth-child("+bI+")").children("span:first-child").addClass("hide");az=$("#date_range>ul>li:nth-child("+bI+")").children("span:first-child").text()}}function bo(){$("#query_ticket").unbind("click");$("#query_ticket").removeClass().addClass("btn122s btn-disabled");d();setTimeout(function(){X();c();$("#query_ticket").removeClass().addClass("btn122s ")},5000)}changeArriveDate=function(bC,bB){bC=bC.replace(":","");bB=bB.replace(":","");hour_value=Number(bC.substring(0,2))+Number(bB.substring(0,2));min_value=Number(bC.substring(2,4))+Number(bB.substring(2,4));if(min_value>=60){hour_value=hour_value+1}if(hour_value>=24&&hour_value<48){return"次日"}else{if(hour_value>=48&&hour_value<72){return"两日"}else{if(hour_value>=72){return"三日"}else{return"当日"}}}};changeLiShi=function(bB){if(bB.substring(0,1)=="0"){if(bB.substring(1,2)=="0"){if(bB.substring(3,4)=="0"){bB=bB.substring(4,5)+"分"}else{bB=bB.substring(3,5)+"分"}}else{bB=bB.substring(1,2)+"小时"+bB.substring(3,5)+"分"}}else{if(bB.substring(3,5)=="00"){bB=bB.substring(0,2)+"小时"}else{bB=bB.substring(0,2)+"小时"+bB.substring(3,5)+"分"}}return bB};isNum=function(bB){return parseInt(bB)};buttonText=function(){return"预订"}})();
var left_ticket_messages={"leftTicketDTO.from_station":"出发站","leftTicketDTO.to_station":"目的站","leftTicketDTO.train_no":"车次","leftTicketDTO.train_date":"出发日",back_train_date:"返程日"};
jQuery.validator.addMethod("checkLoginUserName",function(f,d){var a=false;var c=/^(13[0-9])|(14[0-9])|(15[0-9])|(18[0-9])|(17[0-9])\d{8}$/;var b=/^[A-Za-z]{1}([A-Za-z0-9]|[_]){0,29}$/;var e=/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i;if(b.test(f)||e.test(f)||c.test(f)){a=true}return this.optional(d)||a},"wrong username.");jQuery.validator.addMethod("requiredUserName",function(b,a){if("用户名／邮箱／手机号"==b){return false}if(b==null||""==b){return false}return true},"wrong username.");jQuery.validator.addMethod("requiredSchoolName",function(b,a){if("简码／汉字"==b){return false}if(b==null||""==b){return false}return true},"wrong schoolname.");jQuery.validator.addMethod("randCodeRequired",function(b,a){$("#i-ok").css("display","none");return b.length>0},"验证码错误!");jQuery.validator.addMethod("randCodeFormat",function(c,b){$("#i-ok").css("display","none");var a=/^[a-zA-Z0-9]+$/;return this.optional(b)||a.test(c)},"验证码错误!");jQuery.validator.addMethod("randCodeLength",function(b,a){$("#i-ok").css("display","none");return b.length==4},"验证码错误!.");jQuery.validator.addMethod("integrationCheck",function(b,a){var c=/^\d{6}$/;return this.optional(a)||c.test(b)},"wrong integrationpassword");jQuery.validator.addMethod("integrationPwdCheck",function(b,a,c){if($("#"+c[0]).val()==$("#"+c[1]).val()){return true}return false},"两次输入密码不一致!.");jQuery.validator.addMethod("checkRandCode",function(c,b,d){var a=true;if(c&&c.length==4){$.ajax({url:ctx+"passcodeNew/checkRandCodeAnsyn",type:"post",data:{randCode:c,rand:d},async:false,success:function(e){if(e.data=="N"){a=false;$("#i-ok").css("display","none")}else{a=true;$("#i-ok").css("display","block")}}})}else{a=false;$("#i-ok").css("display","none")}return a},"验证码错误!.");jQuery.validator.addMethod("validateUsersName",function(b,a){return this.optional(a)||/^[A-Za-z]{1}([A-Za-z0-9]|[_]){0,29}$/.test(b)},"用户名只能由字母、数字或_组成");jQuery.validator.addMethod("checkWriteSpace",function(c,b){for(var a=0;a<c.length;a++){if(c.charCodeAt(a)==32){return false}}return true},"contain writespace");jQuery.validator.addMethod("validateRandCode",function(b,a){return this.optional(a)||/^[a-zA-Z0-9]+$/.test(b)},"验证码错误!.");jQuery.validator.addMethod("checkPassward",function(c,b,e){var d=true;for(var a=0;a<c.length;a++){if(c.charCodeAt(a)==39||c.charCodeAt(a)==60||c.charCodeAt(a)==62){d=false}if(!d){break}}return this.optional(b)||d},"Passward wrong");function validateSecIdCard(g){var f=0;var a=g;var e={11:"北京",12:"天津",13:"河北",14:"山西",15:"内蒙",21:"辽宁",22:"吉林",23:"黑龙",31:"上海",32:"江苏",33:"浙江",34:"安徽",35:"福建",36:"江西",37:"山东",41:"河南",42:"湖北",43:"湖南",44:"广东",45:"广西",46:"海南",50:"重庆",51:"四川",52:"贵州",53:"云南",54:"西藏",61:"陕西",62:"甘肃",63:"青海",64:"宁夏",65:"新疆",71:"台湾",81:"香港",82:"澳门",91:"国外"};if(!/^\d{17}(\d|x)$/i.test(a)){return false}a=a.replace(/x$/i,"a");if(e[parseInt(a.substr(0,2))]==null){return false}var c=a.substr(6,4)+"-"+Number(a.substr(10,2))+"-"+Number(a.substr(12,2));var h=new Date(c.replace(/-/g,"/"));if(c!=(h.getFullYear()+"-"+(h.getMonth()+1)+"-"+h.getDate())){return false}for(var b=17;b>=0;b--){f+=(Math.pow(2,b)%11)*parseInt(a.charAt(17-b),11)}if(f%11!=1){return false}return true}function validateFirIdCard(g){var f=0;var a;var e={11:"北京",12:"天津",13:"河北",14:"山西",15:"内蒙",21:"辽宁",22:"吉林",23:"黑龙",31:"上海",32:"江苏",33:"浙江",34:"安徽",35:"福建",36:"江西",37:"山东",41:"河南",42:"湖北",43:"湖南",44:"广东",45:"广西",46:"海南",50:"重庆",51:"四川",52:"贵州",53:"云南",54:"西藏",61:"陕西",62:"甘肃",63:"青海",64:"宁夏",65:"新疆",71:"台湾",81:"香港",82:"澳门",91:"国外"};if(g.length==15){a=idCardUpdate(g)}else{a=g}if(!/^\d{17}(\d|x)$/i.test(a)){return false}a=a.replace(/x$/i,"a");if(e[parseInt(a.substr(0,2))]==null){return false}var c=a.substr(6,4)+"-"+Number(a.substr(10,2))+"-"+Number(a.substr(12,2));var h=new Date(c.replace(/-/g,"/"));if(c!=(h.getFullYear()+"-"+(h.getMonth()+1)+"-"+h.getDate())){return false}for(var b=17;b>=0;b--){f+=(Math.pow(2,b)%11)*parseInt(a.charAt(17-b),11)}if(f%11!=1){return false}return true}function idCardUpdate(g){var b;var f=/^(\d){15}$/;if(f.test(g)){var e=0;var a=new Array(7,9,10,5,8,4,2,1,6,3,7,9,10,5,8,4,2);var d=new Array("1","0","X","9","8","7","6","5","4","3","2");g=g.substr(0,6)+"19"+g.substr(6,g.length-6);for(var c=0;c<g.length;c++){e+=parseInt(g.substr(c,1))*a[c]}g+=d[e%11];b=g}else{b="#"}return b}jQuery.validator.addMethod("checkBorth",function(e,c){var b=e;if(b==""){return true}else{var a=b.match(/^(\d{1,4})(-|\/)(\d{1,2})\2(\d{1,2})$/);if(a==null){return false}var f=new Date(a[1],a[3]-1,a[4]);return(f.getFullYear()==a[1]&&(f.getMonth()+1)==a[3]&&f.getDate()==a[4])}},"日期格式不合法");jQuery.validator.addMethod("byteRangeLength",function(d,b,e){var c=d.length;for(var a=0;a<d.length;a++){if(d.charCodeAt(a)>127){c++}}return this.optional(b)||(c>=e[0]&&c<=e[1])},"length wrong");jQuery.validator.addMethod("checkNameCharBlank",function(c,b,d){var a=d.split("@");if($("#"+a[1]).val()==""){return true}else{if($("#"+a[0]).val()=="1"||$("#"+a[0]).val()=="2"){return this.optional(b)||/^[a-zA-Z·.．\u3400-\u9FFF]+$/.test(c)}else{if($("#"+a[0]).val()=="B"){if(/^[-]+$/.test(c)){return false}return this.optional(b)||/^[a-z A-Z·.．\u3400-\u9FFF\-]+$/.test(c)}else{if($("#"+a[0]).val()=="H"){if(/^[-]+$/.test(c)){return false}return this.optional(b)||/^[a-z A-Z·。.．\u3400-\u9FFF-]+$/.test(c)}else{return this.optional(b)||/^[a-z A-Z·.．\u3400-\u9FFF]+$/.test(c)}}}}},"wrong name.");jQuery.validator.addMethod("checkIdValidStr",function(c,b){var a=/^[a-zA-Z0-9\_\-\(\)]+$/;return this.optional(b)||(a.test(c))},"wrong id");jQuery.validator.addMethod("isSecIDCard",function(b,a,c){if(!checkIfSecIdCard($(c).val())){return true}return validateSecIdCard(b)},"wrong");function checkIfSecIdCard(a){if(a=="1"){return true}return false}function checkIfFirIdCard(a){if(a=="2"){return true}return false}function checkCardForHKorTW(a){if(a=="C"||a=="G"){return true}return false}jQuery.validator.addMethod("isFirIDCard",function(b,a,c){if(!checkIfFirIdCard($(c).val())){return true}return validateFirIdCard(b)},"wrong");jQuery.validator.addMethod("checkHkongMacao",function(c,b,d){if($(d).val()=="C"){var a=/^[HMhm]{1}([0-9]{10}|[0-9]{8})$/;return this.optional(b)||(a.test(c))}else{return true}},"wrong format.");jQuery.validator.addMethod("checkTaiw",function(c,a,e){if($(e).val()=="G"){var d=/^[0-9]{8}$/;var b=/^[0-9]{10}$/;return this.optional(a)||(d.test(c))||(b.test(c))}else{return true}},"wrong format.");jQuery.validator.addMethod("checkPassport",function(d,b,e){if($(e).val()=="B"){var c=/^[a-zA-Z]{5,17}$/;var a=/^[a-zA-Z0-9]{5,17}$/;return this.optional(b)||(a.test(d))||c.test(d)}else{return true}},"wrong format.");jQuery.validator.addMethod("checkWork",function(c,b,d){if($(d).val()=="H"){var a=/^[a-zA-Z]{3}[0-9]{12}$/;return this.optional(b)||(a.test(c))}else{return true}},"wrong format.");jQuery.validator.addMethod("isMobile",function(d,b){var c=d.length;var a=/^(13[0-9])|(14[0-9])|(15[0-9])|(18[0-9])|(17[0-9])\d{8}$/;return this.optional(b)||(c==11&&a.test(d))},"wrong mobile phone ");jQuery.validator.addMethod("isTelePhone",function(b,a){var c=/(^[0-9]{3,4}\-[0-9]{3,8}$)|(^[0-9]{3,8}$)|(^[0-9]{3,4}\)[0-9]{3,8}$)|(^0{0,1}13[0-9]{9}#)/;return this.optional(a)||(c.test(b))},"wrong telePhone ");jQuery.validator.addMethod("illegalChar",function(c,b,e){var d=true;if(c.indexOf("$")>=0){return false}for(var a=0;a<c.length;a++){if(c.charCodeAt(a)==39||c.charCodeAt(a)==60||c.charCodeAt(a)==62||c.charCodeAt(a)==34||c.charCodeAt(a)==63){d=false}if(!d){break}}return this.optional(b)||d},"Illegal char wrong");jQuery.validator.addMethod("isZipCode",function(c,b){var a=/^[0-9]{6}$/;return this.optional(b)||(a.test(c))},"wrong zipcode");jQuery.validator.addMethod("isEmail",function(c,a){var b=/^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/;return this.optional(a)||(b.test(trim(c)))},"wrong email");function replaceChar(b){var a=b.value.replace(/['"<> ?]/g,"");b.value=a}function checkNameChar1(a){return/^[a-zA-Z0-9\u3400-\u9FFF]+$/.test(a)}function trim(a){return a.replace(/(^\s*)|(\s*$)/g,"")}function ltrim(a){return a.replace(/(^\s*)/g,"")}function rtrim(a){return a.replace(/(\s*$)/g,"")}jQuery.validator.addMethod("validateName",function(b,a){return this.optional(a)||/^[a-zA-Z\u3400-\u9FFF0-9\_]+$/.test(b)},"wrong username.");jQuery.validator.addMethod("studentRequired",function(b,a,c){if($(c).val()=="3"){return b&&trim(b)!=""}return true},"wrong studentRequired.");jQuery.validator.addMethod("studentStationRequired",function(b,a,c){if($(c).val()=="3"){return b&&trim(b)!="简拼/全拼/汉字"&&trim(b)!=""}return true},"wrong studentStationRequired.");jQuery.validator.addMethod("studentValidateName",function(b,a,c){if($(c).val()=="3"){return this.optional(a)||/^[a-zA-Z\u3400-\u9FFF0-9\_]+$/.test(b)}return true},"wrong username.");jQuery.validator.addMethod("checkStudentName",function(b,a,c){if($(c).val()=="3"){if((!b||trim(b)==""||trim(b)=="简码/汉字")){return false}}return true},"wrong username.");jQuery.validator.addMethod("isQuestionNull",function(b,a,c){if(jQuery.trim(b)!=""){if(jQuery.trim($(c[0]).val())=="customQuestion"&&jQuery.trim($(c[1]).val())==""||jQuery.trim($(c[0]).val())==""){return false}}return true},"you should input the question");jQuery.validator.addMethod("isAnswerNull",function(b,a,c){if((jQuery.trim($(c[0]).val())=="customQuestion"&&jQuery.trim($(c[1]).val())!="")||(jQuery.trim($(c[0]).val())!="")){if(jQuery.trim(b)==""){return false}}return true},"you should input the answer");function checkSex(c,b,a){if(!checkSexByCardId(c,b,a)){if(!confirm("性别与身份证中的性别不符，是否继续?")){return false}else{return true}}else{return true}}function checkSexByCardId(c,e,a){function b(h,i){var g=null;if(i.length==15){g=i.substring(14,15)}else{if(i.length==18){g=i.substring(16,17)}else{return true}}if(g=="x"||g=="X"){g="10"}var f=parseInt(g);var j=f%2;if(j===0&&h==="F"){return true}else{if(j===1&&h==="M"){return true}else{return false}}}var d=$(a).val();if(checkIfSecIdCard($(e).val())&&validateSecIdCard(d)){if(d!==""){return b(c,d)}else{return true}}else{if(checkIfFirIdCard($(e).val())&&validateFirIdCard(d)){if(d!==""){return b(c,d)}else{return true}}else{return true}}}function checkBirdDateByCardId(c,e,b){var a=null;var d=$(b).val();if(checkIfSecIdCard($(e).val())&&d!==""&&validateSecIdCard(d)){a=d.substring(6,14)}else{if(checkIfFirIdCard($(e).val())&&d!==""&&validateFirIdCard(d)){if(d.length==15){a="19"+d.substring(6,12)}else{if(d.length==18){a=d.substring(6,14)}}}else{return true}}if(c!==""){c=c.replace(/-/g,"");if(c!=a){return false}else{return true}}else{return true}}function checkBirdate(c,b,a){if(!checkBirdDateByCardId(c,b,a)){if(!confirm("出生日期与身份证中的出生日期不符，是否继续?")){return false}else{return true}}else{return true}}jQuery.validator.addMethod("checkPwdValidate",function(b,a){return this.optional(a)||/(?![a-z]+$|[0-9]+$|_+$)^[a-zA-Z0-9_]{6,}$/.test(b)},"contain writespace");jQuery.validator.addMethod("checkConfirmPassWard",function(b,a,c){if($(c).val()!=null){return $(c).val()==b}return true},"contain writespace");jQuery.validator.addMethod("IVR_passwd_format",function(b,a){var c=/^[0-9]{6}$/;return this.optional(a)||c.test(b)},"验证码错误!.");jQuery.validator.addMethod("checkStation",function(b,a){if((!b||trim(b)==""||trim(b)=="简拼/全拼/汉字"||trim(b)=="简拼/全拼/汉字或↑↓")){return false}return true},"wrong username.");jQuery.validator.addMethod("checkAnsyUserName",function(e,c,f){var b=f[0];var d=$("#"+f[1]).val();var a=true;$.ajax({url:b+"?user_name="+e,type:"get",async:false,success:function(g,h){if(g.data==true){a=false}else{a=true}},error:function(g,i,h){a=false}});return a},"wrong cardNo");function checkPwdRank(e,a,d){var b=$(e);var c=b.val();if(c.length<=6||new RegExp("^[a-zA-Z]{6,}$").test(c)||new RegExp("^[0-9]{6,}$").test(c)||new RegExp("^[_]{6,}$").test(c)){$("#"+a).attr("title","危险");$("#"+d).html("危险");$("#"+a).removeClass("rank-a");$("#"+a).removeClass("rank-b");$("#"+a).removeClass("rank-c");$("#"+a).addClass("rank-a")}else{if(c.length>6&&new RegExp("[a-zA-Z]").test(c)&&new RegExp("[0-9]").test(c)&&new RegExp("[_]").test(c)){$("#"+a).attr("title","安全");$("#"+d).html("安全");$("#"+a).removeClass("rank-a");$("#"+a).removeClass("rank-b");$("#"+a).removeClass("rank-c");$("#"+a).addClass("rank-c")}else{$("#"+a).attr("title","一般");$("#"+d).html("一般");$("#"+a).removeClass("rank-a");$("#"+a).removeClass("rank-b");$("#"+a).removeClass("rank-c");$("#"+a).addClass("rank-b")}}}Array.prototype.unique=function(){var b={},a=this.length;for(var c=0;c<a;c++){if(typeof b[this[c]]=="undefined"){b[this[c]]=1}}this.length=0;a=0;for(var c in b){this[a++]=c}return this};function checkSearchPwdRank(h,c,g){var e=$(h);var f=e.val();if(f.length<6){$("#"+c).attr("title","危险");$("#"+g).html("危险");$("#"+c).removeClass("rank-a");$("#"+c).removeClass("rank-b");$("#"+c).removeClass("rank-c");$("#"+c).addClass("rank-a")}else{var a=[];for(var b=0;b<6;b++){a.push(f.charAt(b))}a=a.unique();var d=a.length;if(d==1){$("#"+c).attr("title","危险");$("#"+g).html("危险");$("#"+c).removeClass("rank-a");$("#"+c).removeClass("rank-b");$("#"+c).removeClass("rank-c");$("#"+c).addClass("rank-a")}else{if(d>1&&d<5){$("#"+c).attr("title","一般");$("#"+g).html("一般");$("#"+c).removeClass("rank-a");$("#"+c).removeClass("rank-b");$("#"+c).removeClass("rank-c");$("#"+c).addClass("rank-b")}else{$("#"+c).attr("title","安全");$("#"+g).html("安全");$("#"+c).removeClass("rank-a");$("#"+c).removeClass("rank-b");$("#"+c).removeClass("rank-c");$("#"+c).addClass("rank-c")}}}}jQuery.validator.addMethod("checkDetailAddress",function(b,a){return this.optional(a)||/^[0-9a-zA-Z\u3400-\u9FFF\#]+$/.test(b)},"wrong name.");jQuery.validator.addMethod("checkAddressName",function(b,a){if(/^[-]+$/.test(b)){return false}return this.optional(a)||/^[a-z A-Z·.．\u3400-\u9FFF\-]+$/.test(b)||/^[a-zA-Z·.．\u3400-\u9FFF]+$/.test(b)},"wrong name.");jQuery.validator.addMethod("checkAddressSelect",function(b,a){if(""==b){return false}if(b){return true}return this.optional(a)},"wrong name.");
var login_messages={randCodeError:"验证码错误!",randCodeExpired:"验证码失效",randCodeLentgh:"验证码长度为4位!",randCodeFormat:"验证码只能由数字或字母组成!",randCodeEmpty:"验证码不能为空!",userNameEmpty:"登录名必须填写!",userNameFormat:"登录名格式不正确，请重新输入!",passwordEmpty:"密码必须填写,且不少于6位!",passwordLength:"密码长度不能少于6位!",pleaseClickCaptcha:"请点击验证码",pleaseClickLeftCaptcha:"请点击左侧验证码",pleaseClickCaptchaRight:"请点击正确的验证码",pleaseClickBottomCaptcha:"请点击下方验证码",loginError:"当前访问用户过多,请稍候重试!",submitAfterVerify:"提交",pleaseClickSubmitButtonAfterClick:"pleaseClickSubmitButtonAfterClick",leftTicketOrderNoteMessage:'点击"提交"按钮获取验证码',leftTicketOrderClickCallbackNoteMessage:'完成选择后，继续点击下方橙色"提交"按钮提交订单',leftTicketOrderShowCallbackNoteMessage:"按照提示点击选择所有的图片",leftTicketOrderHiddenCallbackNoteMessage:'点击"提交"按钮获取验证码',getCaptchaByClick:"点击获取验证码"};
